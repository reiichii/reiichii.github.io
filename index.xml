<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>æ—¥ã€…ã®ã‚ã‚Œã“ã‚ŒÏ†(ï¼ï¼)</title><link>https://reiichii.github.io/</link><description>Recent content on æ—¥ã€…ã®ã‚ã‚Œã“ã‚ŒÏ†(ï¼ï¼)</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 06 Sep 2022 22:20:50 +0900</lastBuildDate><atom:link href="https://reiichii.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚¿ãƒ¼ä»˜ããƒ›ãƒ†ãƒ«ã¨æ¸©æ³‰ã§å„ªå‹ã—ã¦ããŸ</title><link>https://reiichii.github.io/post/2022-09-06-22/</link><pubDate>Tue, 06 Sep 2022 22:20:50 +0900</pubDate><guid>https://reiichii.github.io/post/2022-09-06-22/</guid><description>&lt;img src="https://reiichii.github.io/post/2022-09-06-22/IMG_8438.jpg" alt="Featured image of post ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚¿ãƒ¼ä»˜ããƒ›ãƒ†ãƒ«ã¨æ¸©æ³‰ã§å„ªå‹ã—ã¦ããŸ" />&lt;p>è²·ã£ã¦ã¾ã è¦‹ã¦ã„ãªã„ãƒ©ã‚¤ãƒ–DVDã‚’ãƒ›ãƒ†ãƒ«ã«ç¯­ã£ã¦é‘‘è³ã—ãŸã„ãªãƒ¼ğŸ¥ºğŸ¥ºğŸ¥ºãã—ã¦ã§ãã‚Œã°å¤§æµ´å ´ã¨ç¾å‘³ã—ã„æœé£Ÿã‚‚ä»˜ã„ã¦ã„ã¦æ¬²ã—ã„ãªãƒ¼ğŸ¥ºğŸ¥ºã¨ã„ã†ã¨ã“ã‚ã‹ã‚‰å§‹ã¾ã‚Šã€æœ‰çµ¦å–ã£ã¦è¡Œã£ã¦ãã¾ã—ãŸã€‚&lt;/p>
&lt;p>ãŸã æ®‹å¿µãªãŒã‚‰éƒ¨å±‹ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚¿ãƒ¼ãŒä»˜ã„ã¦ã„ã¦ã€ä¸”ã¤æŒã¡è¾¼ã¿ã®DVDã‚’å†ç”Ÿã§ãã¦ã€ä¸”ã¤å¤§æµ´å ´ãŒä»˜ã„ã¦ã€ä¸”ã¤ä¸€äººäºŒäººç”¨ã®éƒ¨å±‹ã¨ã„ã†ã®ã¯æ¢ã—ãŸé™ã‚Šã§ã¯è¦‹ã¤ã‹ã‚‰ãšã€å¤§æµ´å ´ã‚’è«¦ã‚ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ãŸã å¶ç„¶ã«ã‚‚ãƒ›ãƒ†ãƒ«ã‹ã‚‰å¾’æ­©åœå†…ã§è¡Œã‘ã‚‹ã¨ã“ã‚ã«éŠ­æ¹¯ãŒã‚ã‚Šã€å¤§æµ´å ´ã§ã¯ãªã„ã‚‚ã®ã®ã‚µã‚¦ãƒŠãŒã‚ã£ã¦æ¸©æ³‰ãŒæ²¸ã„ã¦ã„ã‚‹ã¨ã®ã“ã¨ã§çµæœçš„ã«ã»ã¨ã‚“ã©å¶ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;blockquote class="twitter-tweet">&lt;p lang="ja" dir="ltr">ãƒ›ãƒ†ãƒ«ã«ç± ã£ã¦ãƒ©ã‚¤ãƒ–DVDã‚’è¦³ã‚‹ä¼šâœŒï¸éƒ¨å±‹ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ã§è¶…ç¶ºéº—ã ã£ãŸã€‚ç‹­ã„ã‘ã©æ­£æ–¹å½¢ãªã®ã§å…¨ç„¶åœ§è¿«æ„Ÿãªãã€ä½ã‚ã‚‹ã€‚ãƒªã‚¯ãƒ©ã‚¤ãƒ‹ãƒ³ã‚°ãƒ™ãƒƒãƒ‰ã¨ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã®ä¸Šä¸‹ã‚’å‚™ãˆä»˜ã‘ã®iPodã§æ“ä½œã§ããŸã‚Šã€‚ã“ã‚Œãªã‚‰å†·æˆ¿ã¨ç…§æ˜ã‚‚ã§ãã‚‹ã‚ˆã†ã«ã—ã¦æ¬²ã—ã‹ã£ãŸç¬‘ &lt;a href="https://t.co/fZ073wTy2D">pic.twitter.com/fZ073wTy2D&lt;/a>&lt;/p>&amp;mdash; ğŸ¥šğŸ¥šğŸ¥š (@reiichii01) &lt;a href="https://twitter.com/reiichii01/status/1566999622291431426?ref_src=twsrc%5Etfw">September 6, 2022&lt;/a>&lt;/blockquote>
&lt;script async src="https://platform.twitter.com/widgets.js" charset="utf-8">&lt;/script>
&lt;p>è¡Œã£ãŸãƒ›ãƒ†ãƒ«ã¯ã“ã¡ã‚‰ã€‚&lt;/p>
&lt;p>ã¡ã‚‡ã£ã¨ã—ãŸå•ã„åˆã‚ã›ã¯å…¨éƒ¨å…¬å¼ã‚µã‚¤ãƒˆã®ãƒãƒ£ãƒƒãƒˆã§æ¸ˆã‚€ã®ã‚‚ä¾¿åˆ©ã§è‰¯ã‹ã£ãŸã€‚ã¾ãŸè¡ŒããŸã„ã€‚&lt;/p>
&lt;iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.slashhotels.com%2F" title="ã€å…¬å¼ã€‘slashå·å´ (ã‚¹ãƒ©ãƒƒã‚·ãƒ¥å·å´)ï½œãƒ‡ã‚¸ã‚¿ãƒ«ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã‚’æ´»ç”¨ã—ãŸãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«ãƒ›ãƒ†ãƒ«" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 680px; margin: 10px 0px;" loading="lazy">&lt;/iframe>
&lt;p>éŠ­æ¹¯ã¯æ­©ã„ã¦5åˆ†ã»ã©ã®ã¨ã“ã‚ã«ã‚ã‚‹æ”¿ä¹‹æ¹¯ã¨ã„ã†ã¨ã“ã‚ã€‚&lt;/p>
&lt;p>å»ºç‰©ã¯å¤ãã‚·ãƒ£ãƒ¯ãƒ¼ãƒ˜ãƒƒãƒ‰ã¯å‹•ã‹ãšæµ´æ§½ã¯å°ã•ã„ã®ã§ã™ãŒã€æ¸…æ½”æ„ŸãŒã‚ã£ã¦å¤©äº•é«˜ãã¦å±…å¿ƒåœ°ã¯è‰¯ã‹ã£ãŸã§ã™ã€‚ä½•ã‚ˆã‚Šã‚µã‚¦ãƒŠãŒä»˜ã„ã¦ã„ã¦(å¾Œã‹ã‚‰ä½œã‚‰ã‚ŒãŸã®ã‹ç¶ºéº—ã ã£ãŸ)ã€å·å´å¤©ç„¶æ¸©æ³‰ãªã‚‹é»’ã„æ¹¯ãŒæ²¸ã„ã¦ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fk-o-i.jp%2Fkoten%2Fmasanoyu-kawa%2F" title="æ”¿ã®æ¹¯ | ã€å…¬å¼ã€‘ç¥å¥ˆå·ã®éŠ­æ¹¯æƒ…å ±" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 680px; margin: 10px 0px;" loading="lazy">&lt;/iframe>
&lt;ul>
&lt;li>15:00 ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³&lt;/li>
&lt;li>è²·ã„å‡ºã—&lt;/li>
&lt;li>ãƒ©ã‚¤ãƒ–DVD1æœ¬ç›®é‘‘è³&lt;/li>
&lt;li>éŠ­æ¹¯è¡Œã&lt;/li>
&lt;li>æ•£æ­©ãŒã¦ã‚‰ãƒ‰ãƒŸãƒãƒ”ã‚¶(å¾’æ­©10åˆ†)ã¾ã§æ­©ã„ã¦å¤•é£¯èª¿é”&lt;/li>
&lt;li>ãƒ©ã‚¤ãƒ–DVD2æœ¬ç›®é‘‘è³&lt;/li>
&lt;li>å¯ã‚‹&lt;/li>
&lt;li>èµ·ãã‚‹&lt;/li>
&lt;li>ãƒ›ãƒ†ãƒ«ã®ã‚«ãƒ•ã‚§ã§æœé£Ÿ&lt;/li>
&lt;li>èª­æ›¸&lt;/li>
&lt;li>11:00 ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ&lt;/li>
&lt;/ul>
&lt;p>ãªå…·åˆã§å·£ç¯­ã‚‚ã‚Šæº€å–«ã§ãã¦æº€è¶³ã§ã—ãŸâ˜ºï¸&lt;/p>
&lt;p>&lt;img src="https://reiichii.github.io/post/2022-09-06-22/IMG_8438.jpg"
width="2736"
height="2077"
srcset="https://reiichii.github.io/post/2022-09-06-22/IMG_8438_hu4858278573ce4ed581962d459c2ca03b_1191585_480x0_resize_q75_box.jpg 480w, https://reiichii.github.io/post/2022-09-06-22/IMG_8438_hu4858278573ce4ed581962d459c2ca03b_1191585_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="131"
data-flex-basis="316px"
>&lt;/p>
&lt;p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚¿ãƒ¼ã‚„DVDå†ç”Ÿæ©Ÿå™¨ãŒå¿…è¦ãªã‘ã‚Œã°ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã¨å¤§æµ´å ´(ã—ã‹ã‚‚æ¸©æ³‰)ã¨æœé£Ÿä»˜ã„ãŸã“ã¡ã‚‰ã®ãƒ›ãƒ†ãƒ«ã«è¡ŒããŸã‹ã£ãŸã€‚&lt;/p>
&lt;p>ã¾ãŸåˆ¥ã®æ©Ÿä¼šã«ã€‚&lt;/p>
&lt;iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.superhotel.co.jp%2Fs_hotels%2Fginza%2F" title="ã€å…¬å¼æœ€å®‰ã€‘ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ›ãƒ†ãƒ«PremieréŠ€åº§ - æ±äº¬éƒ½ä¸­å¤®åŒºéŠ€åº§ã®ãƒ“ã‚¸ãƒã‚¹ãƒ›ãƒ†ãƒ«" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 680px; margin: 10px 0px;" loading="lazy">&lt;/iframe></description></item><item><title>ISUCON12äºˆé¸å•é¡Œè§£ãç›´ã—2</title><link>https://reiichii.github.io/post/2022-09-04-22/</link><pubDate>Sun, 04 Sep 2022 22:28:00 +0900</pubDate><guid>https://reiichii.github.io/post/2022-09-04-22/</guid><description>&lt;p>&lt;a class="link" href="http://localhost:1313/post/2022-08-27-15/" target="_blank" rel="noopener"
>å‰å›ã®è¨˜äº‹&lt;/a>ã®ç¶šãã§ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://isucon.net/archives/56842718.html" target="_blank" rel="noopener"
>ISUCON12 äºˆé¸ã®è§£èª¬ (Node.jsã§SQLiteã®ã¾ã¾10ä¸‡ç‚¹è¡Œãæ–¹æ³•) : ISUCONå…¬å¼Blog&lt;/a>ã‚’å‚è€ƒã«Pythonã§è§£ãç›´ã—ã¦ã„ã¾ã—ãŸã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒã‚’åˆ†ã‘ã‚‹æ‰‹å‰ã¾ã§æ”¹å–„ã—ãŸã®ã§ã™ãŒmax6500ç‚¹ã¾ã§ã—ã‹ã„ã‹ãšã€åˆ†ã‘ã¦ã‚‚10ä¸‡ç‚¹ã©ã“ã‚ã‹äºˆé¸çªç ´ç›¸å½“ã®24000ç‚¹ã«å±Šãã‹ã•ãˆæ€ªã—ã‹ã£ãŸã®ã§é “æŒ«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>è¿½åŠ ã§å®Ÿæ–½ã§ããŸã‚‚ã®&lt;/p>
&lt;ul>
&lt;li>tenantDB player_scoreã«INDEXã‚’ã¯ã‚‹&lt;/li>
&lt;li>Ranking APIã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°é›†è¨ˆã™ã‚‹ã®ã‚’ã‚„ã‚ã‚‹&lt;/li>
&lt;/ul>
&lt;p>è‡ªåˆ†ã§è¿½åŠ ã§è¡Œã£ãŸã“ã¨&lt;/p>
&lt;ul>
&lt;li>scoreã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¦‹ç›´ã—&lt;/li>
&lt;li>Finish APIã§BillingReportã‚’ç”Ÿæˆã™ã‚‹ ã®ä¿®æ­£&lt;/li>
&lt;li>lockã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãŒå¤šç™ºã—ãŸã®ã§ä¸€æ—¦timeoutã‚’ä¼¸ã°ã™&lt;/li>
&lt;li>players/addã®æ”¹å–„&lt;/li>
&lt;/ul>
&lt;p>å®Ÿæ–½ã—ãªã‹ã£ãŸã‚‚ã®&lt;/p>
&lt;ul>
&lt;li>AddTenant APIã§SQLite DBã‚’ä½œã‚‹ã®ã‚’ã‚„ã‚ã‚‹&lt;/li>
&lt;li>nginxã§è¤‡æ•°å°ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹&lt;/li>
&lt;li>nginxã‚’upstream keepaliveã™ã‚‹&lt;/li>
&lt;li>MySQLã‚’ã¡ã‚‡ã£ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹&lt;/li>
&lt;/ul>
&lt;h2 id="scoreã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¦‹ç›´ã—">scoreã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¦‹ç›´ã—&lt;/h2>
&lt;p>æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯æ™‚ã«3å›ã«1å›ãã‚‰ã„ã®é »åº¦ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ãŸã®ã§ä¿®æ­£ã«ç€æ‰‹ã—ã¾ã—ãŸã€‚
AUTOCOMMITã®è¨­å®šãŒã¡ã‚ƒã‚“ã¨åŠ¹ã„ã¦ã„ãªã‹ã£ãŸæ¨¡æ§˜ã€‚sqlalchemyã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§autocommitãŒåŠ¹ã„ã¦ãŠã‚Šã€scoreã®æ™‚ã ã‘è¨­å®šã‚’ä¸Šæ›¸ãã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/91045ac410fa11ce0fbf7b6bfabf3b08bfe9a3f1" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>ã‚¨ãƒ©ãƒ¼è§£æ¶ˆãŒç›®çš„ã ã£ãŸã®ã§ã‚¹ã‚³ã‚¢ã«å½±éŸ¿ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚&lt;/p>
&lt;p>å‚è€ƒ&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://docs.sqlalchemy.org/en/14/orm/session_transaction.html#setting-isolation-for-individual-transactions" target="_blank" rel="noopener"
>Transactions and Connection Management â€” SQLAlchemy 1.4 Documentation&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://qiita.com/tosizo/items/7a3e2d5b6f2f34867274" target="_blank" rel="noopener"
>SQLAlchemyã®autocommitã«ã¤ã„ã¦ - Qiita&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="finish-apiã§billingreportã‚’ç”Ÿæˆã™ã‚‹-ã®ä¿®æ­£">Finish APIã§BillingReportã‚’ç”Ÿæˆã™ã‚‹ ã®ä¿®æ­£&lt;/h2>
&lt;p>æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã¯é€šã‚‹ã®ã§ã™ãŒãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å…¨ä½“ã®ä¸­ã§1~3å›ã»ã© &lt;code>GET /api/organizer/billing è«‹æ±‚ãƒ¬ãƒãƒ¼ãƒˆã®æ•°ãŒé•ã„ã¾ã™ (want: 5, got: 1)ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€‚&lt;/code> ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹çŠ¶æ…‹ã§ã—ãŸã€‚&lt;/p>
&lt;p>çµ‚ã‚ã£ã¦ã„ãªã„å¤§ä¼šã®æƒ…å ±ã‚‚å‡ºã—ã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã£ãŸã®ã§ã™ãŒã€ãã‚Œã‚‰ã®æƒ…å ±ãŒDBã«ã¯å­˜åœ¨ã—ã¦ã„ãªã„ã®ãŒåŸå› ã§ã—ãŸã€‚å­˜åœ¨ã—ãªã‘ã‚Œã°scoreç­‰ã‚’0ã‚’å…¥ã‚Œã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/9a515f9acb6249dabdc8f1752bbc2f4a56517e5c" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>ä¸Šè¨˜äºŒã¤ã‚’è¡Œãªã£ã¦ã‚¨ãƒ©ãƒ¼ã‚‚ãªããªã‚Šã€ã‚¹ã‚³ã‚¢ãŒå®‰å®šã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ãŸã ã—è² è·èµ°è¡Œä¸­ã«SQLite3ã§lockã‚¨ãƒ©ãƒ¼ãŒå¤šç™ºã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚&lt;/p>
&lt;h2 id="tenantdb-player_scoreã«indexã‚’ã¯ã‚‹">tenantDB player_scoreã«INDEXã‚’ã¯ã‚‹&lt;/h2>
&lt;p>åˆæœŸåŒ–æ™‚ã«initial_dataã‚’tenant_dbé…ä¸‹ã«ã‚³ãƒ”ãƒ¼ã—ã¦ã„ã‚‹ã®ã§initial_dataã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã—ã¦INDEXã‚’è¿½åŠ ã—ã¾ã™ã€‚
ãƒ†ãƒŠãƒ³ãƒˆã”ã¨ã«dbãŒã‚ã‚‹ã®ã§ã‚·ã‚§ãƒ«ã§ã¾ã¨ã‚ã¦é©ç”¨ã—ã¦ã‚ã’ã¾ã™ï¼ˆãƒ–ãƒ­ã‚°ã«æ›¸ã„ã¦ã‚ã£ãŸã‚³ãƒãƒ³ãƒ‰ã‚’ãã®ã¾ã¾å®Ÿè¡Œã—ã¾ã—ãŸï¼‰&lt;/p>
&lt;p>ã‚¯ã‚¨ãƒªï¼š&lt;code>create index idx_score on player_score (tenant_id, competition_id, player_id);&lt;/code>&lt;/p>
&lt;p>&lt;code>for db in *.db; do echo &amp;quot;CREATE INDEX...&amp;quot; | sqlite3 $db; done&lt;/code>&lt;/p>
&lt;p>ã¡ãªã¿ã«player_scoreä»¥å¤–ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ãƒ‡ãƒ¼ã‚¿é‡ãŒ100ä»¶ç¨‹åº¦ã—ã‹ãªãã€è²¼ã£ã¦ã‚‚æ„å‘³ãªã•ãã†ãªã®ã§ãã®ã¾ã¾ã«ã—ã¾ã—ãŸã€‚
SQLite3ã®å®Ÿè¡Œè¨ˆç”»ã¯ ã‚¯ã‚¨ãƒªã®é ­ã«&lt;code>EXPLAIN QUERY PLAN&lt;/code> ã‚’ä»˜ã‘ã¾ã™ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code># player/&amp;lt;player_id&amp;gt;æ™‚
EXPLAIN QUERY PLAN SELECT c.title AS title, p.score AS score
FROM player_score AS p
INNER JOIN competition AS c ON c.id = p.competition_id
WHERE c.tenant_id = ?
AND p.player_id = ?
ORDER BY c.created_at ASC
# çµæœ
|--SCAN p
|--SEARCH c USING INDEX sqlite_autoindex_competition_1 (id=?)
`--USE TEMP B-TREE FOR ORDER BY
&lt;/code>&lt;/pre>&lt;p>ç‚¹æ•°ã¯500ç‚¹ã»ã©ä¸ŠãŒã£ãŸã®ã§ã™ãŒã€ãã‚Œä»¥ä¸Šã«DBã®lockã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãŒã²ã©ãã€41%å¤±ç‚¹ã—ã¦ã„ã‚‹æœ‰æ§˜ã§ã—ãŸã€‚&lt;/p>
&lt;h2 id="lockã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãŒå¤šç™ºã—ãŸã®ã§ä¸€æ—¦timeoutã‚’ä¼¸ã°ã™">lockã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãŒå¤šç™ºã—ãŸã®ã§ä¸€æ—¦timeoutã‚’ä¼¸ã°ã™&lt;/h2>
&lt;p>ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’ä¼¸ã°ã™ã—ã‹æ€ã„æµ®ã‹ã°ãªã‹ã£ãŸã®ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’èª¿ã¹ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãŸæ„Ÿã˜Pythonã®SQLite3ã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¨­å®šãŒãã®ã¾ã¾åæ˜ ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ãã‚ŒãŒ5sã§ã—ãŸã€‚
30sã«è¨­å®šã—ã¦ã¿ãŸã¨ã“ã‚lockã«ã‚ˆã‚‹500ã‚¨ãƒ©ãƒ¼ã¯å¤§å¹…ã«æ¸›ã‚‰ã›ã¾ã—ãŸã€‚ãŸã ã—clientå´ã§connection timeoutãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã®ã§ã™ãŒã²ã¨ã¾ãš1ä»¶ç¨‹åº¦ã¾ã§æŠ‘ãˆã‚‰ã‚ŒãŸã®ã§ä¸€æ—¦ã‚ˆã—ã¨ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/74691d3703b159842f71a2c409156028e87b142b" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;h2 id="ranking-apiã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°é›†è¨ˆã™ã‚‹ã®ã‚’ã‚„ã‚ã‚‹">Ranking APIã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°é›†è¨ˆã™ã‚‹ã®ã‚’ã‚„ã‚ã‚‹&lt;/h2>
&lt;blockquote>
&lt;p>ranking APIã®å‘¼ã³å‡ºã•ã‚Œã‚‹å›æ•°ã¨scoreãŒå…¥ç¨¿ã•ã‚Œã‚‹å›æ•°ã¯10ï½20å€ãã‚‰ã„å·®ãŒã‚ã‚‹
rankingã¯scoreã‚’å…¥ç¨¿ã—ãŸã¨ãã—ã‹å¤‰ã‚ã‚‰ãªã„&lt;/p>
&lt;/blockquote>
&lt;p>è¨€ã‚ã‚Œã¦ã¿ã‚Œã°ç¢ºã‹ã«ã€‚&lt;/p>
&lt;p>å¤§ä¼šä¸­ã«ã“ã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«æ°—ã¥ã„ã¦ã„ãŸã‚‰ã¾ãšé–“é•ã„ãªãDELETE+bulk insertã§å¯¾å‡¦ã—ã¦ã„ãŸã¨æ€ã†ã®ã§ã™ãŒã€ &lt;code>ON DUPLICATE KEY UPDATE&lt;/code> ã‚’åˆã‚ã¦çŸ¥ã£ãŸã®ã§ã“ã£ã¡ã§å®Ÿè£…ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;ul>
&lt;li>ON DUPLICATE KEY UPDATE
&lt;ul>
&lt;li>ON DUPLICATE KEY UPDATE ã‚’æŒ‡å®šã—ãŸæ™‚ã€UNIQUEã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¾ãŸã¯Â PRIMARY KEY
Â ã«é‡è¤‡ã—ãŸå€¤ã‚’ç™ºç”Ÿã•ã›ã‚‹è¡ŒãŒæŒ¿å…¥ã•ã‚ŒãŸå ´åˆã€mysqlã«ã‚ˆã£ã¦å¤ã„è¡Œã®å€¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹&lt;/li>
&lt;li>å­˜åœ¨ã—ã¦ã„ã‚Œã°update ã™ã‚‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ã‚„ã‚‹ã“ã¨ã¨ã—ã¦ã¯ä»¥ä¸‹ã§ã™ã€‚&lt;/p>
&lt;ul>
&lt;li>rankingãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">CREATE&lt;/span> &lt;span style="color:#66d9ef">TABLE&lt;/span> ranking (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>tenant_id&lt;span style="color:#f92672">`&lt;/span> BIGINT UNSIGNED &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>competition_id&lt;span style="color:#f92672">`&lt;/span> VARCHAR(&lt;span style="color:#ae81ff">255&lt;/span>) &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>rank&lt;span style="color:#f92672">`&lt;/span> INT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>score&lt;span style="color:#f92672">`&lt;/span> BIGINT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>player_id&lt;span style="color:#f92672">`&lt;/span> VARCHAR(&lt;span style="color:#ae81ff">255&lt;/span>) &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>player_display_name&lt;span style="color:#f92672">`&lt;/span> TEXT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">PRIMARY&lt;/span> &lt;span style="color:#66d9ef">KEY&lt;/span> (&lt;span style="color:#f92672">`&lt;/span>tenant_id&lt;span style="color:#f92672">`&lt;/span>, &lt;span style="color:#f92672">`&lt;/span>competition_id&lt;span style="color:#f92672">`&lt;/span>, &lt;span style="color:#f92672">`&lt;/span>rank&lt;span style="color:#f92672">`&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) ENGINE&lt;span style="color:#f92672">=&lt;/span>InnoDB &lt;span style="color:#66d9ef">DEFAULT&lt;/span> CHARACTER &lt;span style="color:#66d9ef">SET&lt;/span>&lt;span style="color:#f92672">=&lt;/span>utf8mb4;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>row_numã¯ä¸è¦ã ã‹ã‚‰æ¶ˆã—ãŸã¨æ€ã‚ã‚Œã‚‹ã€‚competition_idã•ãˆåˆ†ã‹ã‚Œã°tenant_idã¯ãªãã¦ã‚‚è‰¯ã•ãã†ã«æ€ãˆã‚‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>scoreã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§rankingã‚’ç”Ÿæˆã—ã€insertã™ã‚‹&lt;/li>
&lt;li>åˆæœŸåŒ–å¯¾å¿œ
&lt;ul>
&lt;li>ãŒå¿…è¦ã¨ã®ã“ã¨ã§ã—ãŸãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œç›´ã•ãªãã¦ã‚‚ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãŒé€šã£ãŸã®ã§ã—ã¾ã›ã‚“ã§ã—ãŸã€‚ãƒ‡ãƒ¼ã‚¿ãŒæºœã¾ã£ã¦ã„ã£ã¦ã—ã¾ã†ã®ã‚’é˜²ããŸã‚ã«å‰Šé™¤ã ã‘è¡Œã†ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/2be866a002c2e71dbc2c8b94367c8b3f34b7ed4a" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ä½•åº¦ã‹å®Ÿè¡Œã—ã¦ã„ãŸã®ã§ã™ãŒ6500~5600ã¨æŒ¯ã‚Šå¹…ãŒå¤§ãã„&amp;hellip;ã€‚&lt;/p>
&lt;h2 id="playersaddã®æ”¹å–„">players/addã®æ”¹å–„&lt;/h2>
&lt;p>alpã®çµæœã‚’çœºã‚ã¦ã„ãŸã‚‰ä¸Šè¨˜ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒç•°å¸¸ã«é‡ãŸããªã£ã¦ã„ã¾ã—ãŸã€‚ã‚¹ã‚³ã‚¢ãƒ­ã‚°ã‚’è¦‹è¿”ã™ã¨flockã‚’ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«ã—ãŸã‚ãŸã‚Šã‹ã‚‰ãšã£ã¨ã²ã©ã„çŠ¶æ…‹ã§ã—ãŸç¬‘&lt;/p>
&lt;p>ã‚¹ã‚³ã‚¢ãŒä¼¸ã³æ‚©ã‚“ã§ã„ãŸã®ã‚‚ã‚ã‚Šã€æ°—ã«ãªã£ãŸã®ã§æ”¹å–„ã—ã¦ã¿ã‚ˆã†ã¨ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã ã‚‰ã€ã“ã¡ã‚‰ã‚‚foræ–‡ã®ä¸­ã§é€ä¸€ã‚¯ã‚¨ãƒªãŒç™ºè¡Œã•ã‚Œã¦ã„ã¾ã—ãŸã€‚sqliteã®è² è·ãŒæ‡¸å¿µã ã£ãŸã®ã‚‚ã‚ã‚Šä»¥ä¸‹ã®ã‚ˆã†ã«ãã‚Œãã‚Œã¾ã¨ã‚ã¦å–å¾—ã—ã¦Pythonå´ã§é ‘å¼µã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/3016f0fe8a3198163c6153168ae0159a892990da" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>alpã‚’è¦‹ãŸæ„Ÿã˜æ”¹ä¿®ã®åŠ¹æœã¯å¾—ã‚‰ã‚ŒãŸ(25sâ†’2sã«ãªã£ãŸ)ã®ã§ã™ãŒã€ç‚¹æ•°ã«ã¯å½±éŸ¿ã›ãš&amp;hellip;ã€‚&lt;/p>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>10ä¸‡ã¯ã„ã‹ãªãã¨ã‚‚2ä¸‡ãã‚‰ã„ã¯ã„ããŸã„ãªã¨æ€ã£ã¦ã„ãŸã®ã§ã™ãŒã€ä»Šã®ã¾ã¾è¤‡æ•°å°åˆ†æ•£ã—ã¦ã‚‚ãã“ã¾ã§ä¸ŠãŒã‚‹è¦‹è¾¼ã¿ãŒãªãã€ã ã‚Œã¦ãã¦ã—ã¾ã£ãŸã®ã‚‚ã‚ã‚Šä¸€æ—¦ä¸€åŒºåˆ‡ã‚Šã«ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ğŸ˜“&lt;/p>
&lt;p>å…¨ä½“ã®æ”¹å–„ã®ãƒ­ã‚°ã¯ä»¥ä¸‹ã«ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/issues/1" target="_blank" rel="noopener"
>ã‚¹ã‚³ã‚¢æ¨ç§»ã®ãƒ­ã‚° Â· Issue #1 Â· reiichii/isucon12q-after&lt;/a>&lt;/p>
&lt;p>ISUCON11äºˆé¸å•é¡Œè§£èª¬ã®ã‚„ã‚Šæ–¹ã‚’å‚è€ƒã«æ®‹ã—ã¦ã„ã¾ã—ãŸã€‚&lt;/p></description></item><item><title>ISUCON12äºˆé¸å•é¡Œè§£ãç›´ã—</title><link>https://reiichii.github.io/post/2022-08-27-15/</link><pubDate>Sat, 27 Aug 2022 14:57:37 +0900</pubDate><guid>https://reiichii.github.io/post/2022-08-27-15/</guid><description>&lt;p>8æœˆã¯&lt;a class="link" href="https://isucon.net/archives/56842718.html" target="_blank" rel="noopener"
>ISUCON12 äºˆé¸ã®è§£èª¬ (Node.jsã§SQLiteã®ã¾ã¾10ä¸‡ç‚¹è¡Œãæ–¹æ³•) | ISUCONå…¬å¼Blog&lt;/a>ã‚’è¦‹ãªãŒã‚‰ISUCON12äºˆé¸å•é¡Œã®è§£ãç›´ã—ã‚’ã—ã¦ã„ã¾ã—ãŸã€‚ã¾ã å…¨éƒ¨æ–½ç­–ã‚’ã‚„ã‚Šåˆ‡ã‚Œã¦ãŠã‚‰ãšã€ç‚¹æ•°ã‚‚ä¸ŠãŒã‚Šãã£ã¦ã¯ã„ãªã„ã®ã§ã™ãŒã€1ãƒ¶æœˆçµŒã£ãŸã®ã§é€”ä¸­ã¾ã§ã¾ã¨ã‚ã‚‹ã“ã¨ã«ã€‚&lt;/p>
&lt;p>å®Ÿæ–½ã§ããŸã‚‚ã®&lt;/p>
&lt;ul>
&lt;li>adminDB visit_history ã«INDEXã‚’å¼µã‚‹&lt;/li>
&lt;li>dispenseIDã§MySQLã‚’ä½¿ã†ã®ã‚’ã‚„ã‚ã‚‹&lt;/li>
&lt;li>Ranking APIã®ãƒ«ãƒ¼ãƒ—ã‚¯ã‚¨ãƒªã‚’ãªãã™&lt;/li>
&lt;li>Score APIã®è¿½åŠ ã®ãƒ«ãƒ¼ãƒ—ã‚¯ã‚¨ãƒªã‚’ãªãã™&lt;/li>
&lt;li>ã‚¢ãƒˆãƒŸãƒƒã‚¯æ›¸ãè¾¼ã¿ã®ãŸã‚ã®flockã‚’ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«å¤‰æ›´ã™ã‚‹(â€»æ€ªã—ã„)&lt;/li>
&lt;li>adminDB visit_historyã®åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ã™ã‚‹&lt;/li>
&lt;li>dbç”¨ã‚µãƒ¼ãƒã‚’æŠ•å…¥ã—ã€2å°æ§‹æˆã«ã™ã‚‹&lt;/li>
&lt;li>Finish APIã§BillingReportã‚’ç”Ÿæˆã™ã‚‹(â€»æ€ªã—ã„)&lt;/li>
&lt;li>Player APIã‚’ãªã‚“ã¨ã‹ã™ã‚‹&lt;/li>
&lt;/ul>
&lt;p>ã¾ã ã§ãã¦ã„ãªã„ã‚‚ã®&lt;/p>
&lt;ul>
&lt;li>tenantDB player_scoreã«INDEXã‚’ã¯ã‚‹&lt;/li>
&lt;li>Ranking APIã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°é›†è¨ˆã™ã‚‹ã®ã‚’ã‚„ã‚ã‚‹&lt;/li>
&lt;li>AddTenant APIã§SQLite DBã‚’ä½œã‚‹ã®ã‚’ã‚„ã‚ã‚‹&lt;/li>
&lt;li>nginxã§è¤‡æ•°å°ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹&lt;/li>
&lt;li>nginxã‚’upstream keepaliveã™ã‚‹&lt;/li>
&lt;li>MySQLã‚’ã¡ã‚‡ã£ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹&lt;/li>
&lt;/ul>
&lt;p>åŠåˆ†ä»¥ä¸Šã¯å®Ÿæ–½ã—ã¦ã„ã‚‹ã®ã«æœªã ç‚¹æ•°ãŒ6000ç‚¹ä»£ã¨ã„ã†&amp;hellip;æ€ã£ãŸã‚ˆã‚Šå³ã—ã‹ã£ãŸã€‚&lt;/p>
&lt;h2 id="admindb-visit_history-ã«indexã‚’å¼µã‚‹">adminDB visit_history ã«INDEXã‚’å¼µã‚‹&lt;/h2>
&lt;p>å»å¹´ã®å•é¡Œãªã‚‰initialã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œã‚Šç›´ã—ã¦ã„ã‚‹ã®ã§schemaã«indexã‚’è¿½åŠ ã—ã¦ã„ãŸã®ã§ã™ãŒã€ä»Šå›ã¯å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã¯drop createã¯å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„ã®ã§ã“ã“ã«æ›¸ã„ã¦ã‚‚æ„å‘³ãªã‹ã£ãŸã¨ã„ã†ğŸ™‚&lt;/p>
&lt;p>covering indexã¨ã„ã†æ¦‚å¿µã‚’åˆã‚ã¦çŸ¥ã‚Šã¾ã—ãŸã€‚indexã£ã¦è²¼ã‚Œã¦ã„ã‚Œã°ã„ã„ã¨æ€ã£ã¦ã„ãŸã®ã§ã™ãŒã€å¼µã‚Šæ–¹ã«ã‚ˆã£ã¦ã‚‚æ€§èƒ½(ç‚¹æ•°)ã«å·®ãŒå‡ºã¦ã—ã¾ã†ã‚“ã§ã™ã­ã€‚ã›ã£ã‹ããªã®ã§3ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Ÿè¡Œè¨ˆç”»ã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã—ãŸã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code># æ—¢å­˜
EXPLAIN SELECT player_id, MIN(created_at) AS min_created_at FROM visit_history WHERE tenant_id = 1 AND competition_id = &amp;#39;S&amp;#39; GROUP BY player_id;
+----+-------------+---------------+------------+------+---------------+---------------+---------+-------+---------+----------+------------------------------+
| id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra |
+----+-------------+---------------+------------+------+---------------+---------------+---------+-------+---------+----------+------------------------------+
| 1 | SIMPLE | visit_history | NULL | ref | tenant_id_idx | tenant_id_idx | 8 | const | 1292937 | 10.00 | Using where; Using temporary |
+----+-------------+---------------+------------+------+---------------+---------------+---------+-------+---------+----------+------------------------------+
# covering index
+----+-------------+---------------+------------+------+-----------------------------+---------------+---------+-------------+------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra |
+----+-------------+---------------+------------+------+-----------------------------+---------------+---------+-------------+------+----------+-------------+
| 1 | SIMPLE | visit_history | NULL | ref | tenant_id_idx,idx_all_cover | idx_all_cover | 1030 | const,const | 1 | 100.00 | Using index |
+----+-------------+---------------+------------+------+-----------------------------+---------------+---------+-------------+------+----------+-------------+
# createdãªã—
+----+-------------+---------------+------------+------+-----------------------------+---------------+---------+-------------+------+----------+-------+
| id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra |
+----+-------------+---------------+------------+------+-----------------------------+---------------+---------+-------------+------+----------+-------+
| 1 | SIMPLE | visit_history | NULL | ref | tenant_id_idx,idx_all_cover | idx_all_cover | 1030 | const,const | 1 | 100.00 | NULL |
+----+-------------+---------------+------------+------+-----------------------------+---------------+---------+-------------+------+----------+-------+
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>indexã‚’è¿½åŠ ã™ã‚‹ã¨ã€possible_keys,keyã«idx_all_coverãŒè¿½åŠ ã•ã‚Œã€filteredãŒ100%ã«ãªã‚‹&lt;/li>
&lt;li>covering indexã«ã™ã‚‹ã¨ã€Extraã«Using indexãŒè¡¨ç¤ºã•ã‚Œã‚‹&lt;/li>
&lt;li>createdã‚ã‚Šã¨ãªã—ã§ã¯ã‚¹ã‚³ã‚¢ã«ã¯200ç‚¹ã»ã©å·®ãŒã§ãŸ&lt;/li>
&lt;/ul>
&lt;p>mysqlã®convering indexã¨ã¯&lt;/p>
&lt;ul>
&lt;li>ã‚¯ã‚¨ãƒªãƒ¼ã«ã‚ˆã£ã¦å–å¾—ã•ã‚ŒãŸã™ã¹ã¦ã®ã‚«ãƒ©ãƒ ã‚’å«ã‚€&lt;em>&lt;strong>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹&lt;/strong>&lt;/em>&lt;/li>
&lt;li>æ¤œç´¢ã‚’ç´¢å¼•å†…ã§å®Œçµã§ãã€è¡¨ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚‹å¿…è¦ãŒãªã„ãŸã‚åŠ¹ç‡ãŒè‰¯ã„&lt;/li>
&lt;li>è¡¨ã®ã‚µã‚¤ã‚ºãŒãƒ¡ãƒ¢ãƒªã«ä¿æŒã—ãã‚Œãªã„ã»ã©å¤§ãã„å ´åˆã®æ¤œç´¢ã§æœ‰åŠ¹&lt;/li>
&lt;/ul>
&lt;p>+500ç‚¹ã»ã©&lt;/p>
&lt;h2 id="dispenseidã§mysqlã‚’ä½¿ã†ã®ã‚’ã‚„ã‚ã‚‹">dispenseIDã§MySQLã‚’ä½¿ã†ã®ã‚’ã‚„ã‚ã‚‹&lt;/h2>
&lt;p>ä¸€æ„ãªidã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚ã–ã‚ã–DBã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ãŒã€ã“ã‚Œã‚’uuidã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ã«ã™ã‚‹&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/3409af51893bbda12ca68dc1ff1d1de914b0bb14" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>SQLã®&lt;code>REPLACE INTO&lt;/code>ã¨ã¯&lt;/p>
&lt;ul>
&lt;li>åŸºæœ¬INSERTã¨åŒã˜ã ãŒã€ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã®å¤ã„è¡Œã«privary keyã¾ãŸã¯uniqueã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«é–¢ã—ã¦æ–°ã—ã„è¡Œã¨åŒã˜å€¤ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆãã®å¤ã„è¡Œã¯æ–°ã—ã„è¡ŒãŒæŒ¿å…¥ã•ã‚Œã‚‹å‰ã«å‰Šé™¤ã•ã‚Œã‚‹&lt;/li>
&lt;li>æŒ¿å…¥ or å‰Šé™¤ã¨æŒ¿å…¥ã€€ã®é•ã„&lt;/li>
&lt;/ul>
&lt;p>raise fromã«ã¤ã„ã¦&lt;/p>
&lt;ul>
&lt;li>ä¾‹å¤–ã‚’é€£é–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Python" data-lang="Python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">raise&lt;/span> &lt;span style="color:#a6e22e">ConnectionError&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">except&lt;/span> &lt;span style="color:#a6e22e">ConnectionError&lt;/span> &lt;span style="color:#66d9ef">as&lt;/span> e:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">raise&lt;/span> &lt;span style="color:#a6e22e">RuntimeError&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Failed to open database&amp;#34;&lt;/span>) &lt;span style="color:#f92672">from&lt;/span> e
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>å‡ºåŠ›ã¯ä»¥ä¸‹ï¼š&lt;code>The above exception was the direct cause of the following exception&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Python" data-lang="Python">&lt;span style="display:flex;">&lt;span>Traceback (most recent call last):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> File &lt;span style="color:#e6db74">&amp;#34;~/ghq/github.com/reiichii/isucon12q-after/tmp.py&amp;#34;&lt;/span>, line &lt;span style="color:#ae81ff">2&lt;/span>, &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>module&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">raise&lt;/span> &lt;span style="color:#a6e22e">ConnectionError&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">ConnectionError&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>The above exception was the direct cause of the following exception:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Traceback (most recent call last):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> File &lt;span style="color:#e6db74">&amp;#34;/~/ghq/github.com/reiichii/isucon12q-after/tmp.py&amp;#34;&lt;/span>, line &lt;span style="color:#ae81ff">4&lt;/span>, &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>module&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">raise&lt;/span> &lt;span style="color:#a6e22e">RuntimeError&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Failed to open database&amp;#34;&lt;/span>) &lt;span style="color:#f92672">from&lt;/span> e
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">RuntimeError&lt;/span>: Failed to open database
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>from ã‚’ä½¿ã‚ãªã„ã¨ã€&lt;code>During handling of the above exception, another exception occurred&lt;/code> ã®ã‚ˆã†ã«ãªã‚‹&lt;/li>
&lt;/ul>
&lt;p>+200ç‚¹ã»ã©&lt;/p>
&lt;h2 id="ranking-apiã®ãƒ«ãƒ¼ãƒ—ã‚¯ã‚¨ãƒªã‚’ãªãã™">Ranking APIã®ãƒ«ãƒ¼ãƒ—ã‚¯ã‚¨ãƒªã‚’ãªãã™&lt;/h2>
&lt;p>ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®åˆè¨ˆæ™‚é–“ãŒä¸€ç•ªé•·ã„ /api/player/competition/&amp;lt;competition_id&amp;gt;/ranking ã‚’ãªã‚“ã¨ã‹ã™ã‚‹ã€‚&lt;/p>
&lt;p>N+1ã«ãªã£ã¦ã„ã‚‹ã®ã§joinã‚’ä½¿ã†ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/62e3d7bd4bdaca3b14cc682e0bce6605de907014" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>+1000ç‚¹ã«ãªã‚Šã¾ã—ãŸğŸ˜³&lt;/p>
&lt;h2 id="score-apiã®è¿½åŠ ã®ãƒ«ãƒ¼ãƒ—ã‚¯ã‚¨ãƒªã‚’ãªãã™">Score APIã®è¿½åŠ ã®ãƒ«ãƒ¼ãƒ—ã‚¯ã‚¨ãƒªã‚’ãªãã™&lt;/h2>
&lt;blockquote>
&lt;p>rankingã®æ¬¡ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ åˆè¨ˆãŒå¤§ãã„ã®ã¯scoreãªã®ã§&lt;/p>
&lt;/blockquote>
&lt;p>Node.jsã§è§£ã„ã¦ã„ãŸãƒ–ãƒ­ã‚°è¨˜äº‹ã§ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«æ›¸ã„ã¦ã‚ã£ãŸãŒã€ç§ã®ç’°å¢ƒ(Python)ã§ã¯scoreã‚ˆã‚Šã‚‚/api/player/player/&amp;lt;player_id&amp;gt; ã®æ–¹ãŒé‡ã‹ã£ãŸã§ã™ã€‚&lt;/p>
&lt;p>è‡ªåˆ†ã§ã¯æœ€å¾Œã®insertã®ã¨ã“ã‚ã‚’bulk insertã«ã™ã‚Œã°ã„ã„ã®ã‹ãªã¨æ€ã£ã¦ã„ãŸãŒã€å­˜åœ¨ã—ãªã„player_idã‚’è¿”ã™å¿…è¦ã¯ãªã„ã®ã§æ•°ã‚’æ¯”è¼ƒã™ã‚‹ã ã‘ã§ååˆ†ã¨ã„ã†è€ƒãˆã«ã¯è‡³ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/8f787574d5a847a7f1cc33dc7ecdb4e35a1403d8" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>ã“ã¡ã‚‰ã‚‚+1000ç‚¹ã»ã©&lt;/p>
&lt;h2 id="ã‚¢ãƒˆãƒŸãƒƒã‚¯æ›¸ãè¾¼ã¿ã®ãŸã‚ã®flockã‚’ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«å¤‰æ›´ã™ã‚‹æ€ªã—ã„">ã‚¢ãƒˆãƒŸãƒƒã‚¯æ›¸ãè¾¼ã¿ã®ãŸã‚ã®flockã‚’ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«å¤‰æ›´ã™ã‚‹(â€»æ€ªã—ã„)&lt;/h2>
&lt;p>æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã§ã¯ãƒ†ãƒŠãƒ³ãƒˆDBæ›´æ–°ã®éš›ã«ã€æ’ä»–åˆ¶å¾¡ã‚’ã™ã‚‹ãŸã‚ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ­ãƒƒã‚¯ã™ã‚‹ã“ã¨ã‚’ã—ã¦ã„ã¾ã™ãŒã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã‚ˆã†ã«ã—ã¾ã™ã€‚
delete-insertã®éƒ¨åˆ†ã‚’ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«ã—ã¦flockã‚’å¤–ã™ã€‚ä»–ã®flockã¯å‚ç…§ã®ã¿ãªã®ã§å¤–ã™ã ã‘ã§è‰¯ã‹ã£ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/69b53bfb6318f46cdc0db67e38c1fb64271693a0" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>ã“ã®éƒ¨åˆ†ã‚’å®Ÿè£…ã—ãŸã¨ã“ã‚ã€æ•°å›ã«1å›æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ãŒé€šã‚‰ãªããªã‚Šã¾ã—ãŸğŸ˜¢ãŠãã‚‰ããƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒã¡ã‚ƒã‚“ã¨åŠ¹ã„ã¦ã„ãªã„æ¨¡æ§˜ã§ã€ãªã‚“ã§ã‹å…¨ç„¶åˆ†ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã™ãŒãŠãã‚‰ãAuto CommitãŒåŠ¹ã„ã¦ã—ã¾ã£ã¦ã„ã‚‹ã¨ã“ã‚ã«æ€ã„è‡³ã£ãŸã®ã§ã“ã‚Œã‹ã‚‰ç¢ºèªã™ã‚‹æ®µéšã§ã™ã€‚&lt;/p>
&lt;p>ãã—ã¦ãªãœã‹ç‚¹æ•°ã¯ãã‚Œã»ã©ä¸ŠãŒã‚‰ãªã„ã©ã“ã‚ã‹å®Ÿè¡Œã™ã‚‹ãŸã³ã«æ•°ç™¾ç‚¹ã®æŒ¯ã‚Šå¹…ãŒå‡ºã‚‹ã‚ˆã†ã«ã€‚&lt;/p>
&lt;h2 id="admindb-visit_historyã®åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ã™ã‚‹">adminDB visit_historyã®åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ã™ã‚‹&lt;/h2>
&lt;p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œã‚ŠãŒã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‹ã©ã†ã‹ãŒåˆ†ã‹ã‚Œã°ã„ã„ãŸã‚ã€visit_historyã®ãƒ†ãƒŠãƒ³ãƒˆIDã€å¤§ä¼šIDã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼IDã‚’group byã—ã¦min(created_at) / min(updated_at)ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ãŒæ®‹ã‚‹ã‚ˆã†ã«ã—ã¦é‡è¤‡ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’æ¸›ã‚‰ã™ã€‚&lt;/p>
&lt;p>ã¡ãªã¿ã«å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã®MySQLã®åˆæœŸåŒ–ã®éƒ¨åˆ†ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¦ã€ä¸€å®šã®ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆãªã„ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">DELETE&lt;/span> &lt;span style="color:#66d9ef">FROM&lt;/span> visit_history &lt;span style="color:#66d9ef">WHERE&lt;/span> created_at &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;1654041600&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¿µã®ç‚ºæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’æ®‹ã—ã¦ãŠããŸã‹ã£ãŸã®ã§ã€ç§ã¯ä»¥ä¸‹ã®æ‰‹é †ã§å®Ÿæ–½ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;ol>
&lt;li>ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆï¼ˆvisit_history_tmpã¨ã™ã‚‹ï¼‰&lt;/li>
&lt;li>INSERT SELECT
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">INSERT&lt;/span> &lt;span style="color:#66d9ef">INTO&lt;/span> visit_history_tmp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">SELECT&lt;/span> player_id, tenant_id, competition_id, &lt;span style="color:#66d9ef">MIN&lt;/span>(created_at), &lt;span style="color:#66d9ef">MIN&lt;/span>(updated_at)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">FROM&lt;/span> visit_history
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">GROUP&lt;/span> &lt;span style="color:#66d9ef">BY&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>,&lt;span style="color:#ae81ff">2&lt;/span>,&lt;span style="color:#ae81ff">3&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>å¤ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’rename
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">RENAME&lt;/span> &lt;span style="color:#66d9ef">TABLE&lt;/span> visit_history &lt;span style="color:#66d9ef">TO&lt;/span> visit_history_backup;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’visit_historyã«rename
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">RENAME&lt;/span> &lt;span style="color:#66d9ef">TABLE&lt;/span> visit_history_tmp &lt;span style="color:#66d9ef">TO&lt;/span> visit_history;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>åˆæœŸåŒ–æ™‚ç‚¹ã®è¡Œæ•°ï¼š3,224,839 â†’ å‰Šæ¸›å¾Œã®ãƒ‡ãƒ¼ã‚¿æ•°ï¼š200,474ï¼ˆ0.06%ã«ã¾ã§å‰Šæ¸›ã•ã‚ŒãŸï¼‰&lt;/p>
&lt;p>ãŸã ã—ç§ã®å ´åˆã‚¹ã‚³ã‚¢ã¯å¤‰ã‚ã‚‰ãš&lt;/p>
&lt;h2 id="dbç”¨ã‚µãƒ¼ãƒã‚’æŠ•å…¥ã—2å°æ§‹æˆã«ã™ã‚‹">DBç”¨ã‚µãƒ¼ãƒã‚’æŠ•å…¥ã—ã€2å°æ§‹æˆã«ã™ã‚‹&lt;/h2>
&lt;p>ãƒ–ãƒ­ã‚°ã®æ–¹ã§ã¯è¤‡æ•°å°æ§‹æˆæº–å‚™ã®ãŸã‚ã®æ–½ç­–ã«çªå…¥ã™ã‚‹ã®ã§ã™ãŒã€ç§ã¯å…ˆã«appã¨dbã®äºŒå°æ§‹æˆã«ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;ul>
&lt;li>mysqlã§ä»–ã‚µãƒ¼ãƒã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å®¹ã™ã‚‹&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>CREATE USER `isucon`@`192.168.%` IDENTIFIED BY &amp;#39;isucon&amp;#39;;
GRANT ALL PRIVILEGES ON `isuports`.* TO `isucon`@`192.168.%`;
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>applicationå´ã§å‚ç…§å…ˆdbã‚’å¤‰æ›´
&lt;ul>
&lt;li>ä»Šå›ã¯docker-composeã«ãƒ›ã‚¹ãƒˆãŒæ›¸ã„ã¦ã‚ã£ãŸã®ã§ãã“ã®å€¤ã‚’å¤‰æ›´ã™ã‚‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å‰ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã®æ™‚ç‚¹ã§CPUãŒä½™ã£ã¦ã„ãŸã®ã§ã€ã“ã‚Œã‚„ã£ã¦ã‚‚ç‚¹æ•°ãŒå¤§ã—ã¦å¤‰ã‚ã‚‰ãªã„ã®ã¯äºˆæƒ³é€šã‚Šã§ã—ãŸã€‚&lt;/p>
&lt;h2 id="finish-apiã§billingreportã‚’ç”Ÿæˆã™ã‚‹">Finish APIã§BillingReportã‚’ç”Ÿæˆã™ã‚‹&lt;/h2>
&lt;blockquote>
&lt;p>ä»Šå›ã®å½“æ—¥ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«ã‚ã£ãŸã€ã€ŒFinish APIã‚’å‘¼ã³å‡ºã—ãŸã‚ã¨ã«Admin/Organizerã®Billing APIã«çµæœãŒåæ˜ ã•ã‚Œã‚‹ã¾ã§3ç§’ã®çŒ¶äºˆãŒã‚ã‚‹ã®æ„å‘³ã¯ã€ã€ŒåˆæœŸå®Ÿè£…ã ã¨Billing APIã§è«‹æ±‚é¡ã‚’è¨ˆç®—ã—ã¦ã„ã‚‹ã‘ã©ã€å¤§ä¼šã”ã¨ã«finishã™ã‚‹ã¨ãã«å¤§ä¼šã®è«‹æ±‚é¡ãŒç¢ºå®šã™ã‚‹ã®ã§ã€BillingReportã‚’ãã“ã§ç”Ÿæˆã—ã¦ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã„ã‚Œã¦ã­!ã€ã§ã™ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>åˆ†ã‹ã‚‰ã‚“&amp;hellip;ğŸ˜‡&lt;/p>
&lt;p>finish ãŒå‘¼ã°ã‚ŒãŸæ™‚ã«billing_report_by_competitionã‚’å‘¼ã³å‡ºã—ã¦ã€ãã®çµæœã‚’insertã—ã¾ã™ã€‚&lt;/p>
&lt;ul>
&lt;li>ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">CREATE&lt;/span> &lt;span style="color:#66d9ef">TABLE&lt;/span> &lt;span style="color:#f92672">`&lt;/span>billing_report&lt;span style="color:#f92672">`&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>tenant_id&lt;span style="color:#f92672">`&lt;/span> BIGINT UNSIGNED &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>competition_id&lt;span style="color:#f92672">`&lt;/span> VARCHAR(&lt;span style="color:#ae81ff">255&lt;/span>) &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>competition_title&lt;span style="color:#f92672">`&lt;/span> VARCHAR(&lt;span style="color:#ae81ff">255&lt;/span>) &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>player_count&lt;span style="color:#f92672">`&lt;/span> BIGINT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>visitor_count&lt;span style="color:#f92672">`&lt;/span> BIGINT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>billing_player_yen&lt;span style="color:#f92672">`&lt;/span> BIGINT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>billing_visitor_yen&lt;span style="color:#f92672">`&lt;/span> BIGINT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">`&lt;/span>billing_yen&lt;span style="color:#f92672">`&lt;/span> BIGINT &lt;span style="color:#66d9ef">NOT&lt;/span> &lt;span style="color:#66d9ef">NULL&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">PRIMARY&lt;/span> &lt;span style="color:#66d9ef">KEY&lt;/span>(&lt;span style="color:#f92672">`&lt;/span>tenant_id&lt;span style="color:#f92672">`&lt;/span>, &lt;span style="color:#f92672">`&lt;/span>competition_id&lt;span style="color:#f92672">`&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) ENGINE&lt;span style="color:#f92672">=&lt;/span>InnoDB &lt;span style="color:#66d9ef">DEFAULT&lt;/span> CHARACTER &lt;span style="color:#66d9ef">SET&lt;/span>&lt;span style="color:#f92672">=&lt;/span>utf8mb4;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>finish apiã®æ™‚ã«billing_report_by_competitionã‚’å‘¼ã³å‡ºã—ã¦çµæœã‚’insertã™ã‚‹&lt;/li>
&lt;li>admin/organizationã®billingã®å‚ç…§å…ˆã‚’dbã‹ã‚‰selectã—ã¦å–ã£ã¦ãã‚‹&lt;/li>
&lt;li>åˆæœŸãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå‡¦ç†ã‚’æ”¹ä¿®
&lt;ul>
&lt;li>åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œç›´ã—ãŸã‚ã¨ã«å…¨ã¦ã®çµ‚äº†æ¸ˆã¿å¤§ä¼šã«ã¤ã„ã¦ billingReportByCompetition ã‚’å®Ÿè¡Œã—ã¦INSERTã—ãªãŠã™å¿…è¦ãŒã‚ã‚‹&lt;/li>
&lt;li>billing reportåˆæœŸãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ&lt;/li>
&lt;li>&lt;code>mysqldump -uroot -proot isuports billing_report &amp;gt; initial_billing_report.dump&lt;/code>&lt;/li>
&lt;li>initialæ™‚ã«åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’importã•ã›ã‚‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/64b7251efa85305e548fbfac2c19fed82d2379f9" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>ã‚¹ã‚³ã‚¢ã¯ãã‚Œã»ã©å¤‰ã‚ã‚‰ãšã€ä¸å®‰å®šã•ãŒå¢—ã—ã¦ã—ã¾ã£ãŸã‚ˆã†ã«è¦‹å—ã‘ã‚‰ã‚Œã¾ã—ãŸã€‚(ç·¨é›†ã¨ã¯é–¢ä¿‚ãªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹)
ãŸã &lt;code>api/admin/tenants/billing&lt;/code>, &lt;code>api/organizer/billing&lt;/code>ã®å‘¼ã³å‡ºã—å›æ•°ã¨åˆè¨ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒå¤§å¹…ã«æ”¹å–„ã•ã‚Œã¦ã„ã‚‹ã®ã§ä¸€æ—¦ã‚ˆã—ã¨ã—ã¾ã™ã€‚&lt;/p>
&lt;h2 id="player-apiã‚’ãªã‚“ã¨ã‹ã™ã‚‹">Player APIã‚’ãªã‚“ã¨ã‹ã™ã‚‹&lt;/h2>
&lt;p>ä¸Šè¨˜ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’çœºã‚ã¦ã„ã‚‹ã¨ãã«Player APIãŒã‚‚ã®ã™ã”ãé‡ãŸããªã£ã¦ã„ã‚‹(MAX 5sç¨‹åº¦ã ã£ãŸã‚‚ã®ãŒMAX 30sã«ãªã£ã¦ã„ãŸç¬‘)ã“ã¨ã«æ°—ã¥ãã€ã‚ã¾ã‚Šã«ã‚‚æ°—ã«ãªã£ãŸã®ã§å…ˆã«ç›´ã™ã“ã¨ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12q-after/commit/17801b6a6af423f4ea6bc0670ba91af8c0111660" target="_blank" rel="noopener"
>ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>ã“ã‚Œã‚‚N+1ã‚’ç›´ã™ã ã‘ã§ã™ã€‚å¿…è¦ãªæƒ…å ±ã«å¯¾ã—ã¦å¤šãã‚¯ã‚¨ãƒªã‚’ç™ºè¡Œã—ã¦ã„ã‚‹ã®ã§ã‚¹ãƒªãƒ ã«æ›¸ãç›´ã—ã¦ã‚ã’ã¾ã™ã€‚&lt;/p>
&lt;p>ä»Šã¾ã§4000ç‚¹ä»£ã§ä¼¸ã³æ‚©ã‚“ã§ã„ãŸã‚¹ã‚³ã‚¢ãŒ6000ç‚¹å°ã¾ã§å±Šãã¾ã—ãŸğŸ‘&lt;/p>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>ã‚¹ã‚³ã‚¢ãŒä¼¸ã³æ‚©ã‚“ã§ã€ã¾ãŸä»–ã®ã“ã¨ã‚’ã‚„ã‚ŠãŸããªã£ã¦ããŸã®ã‚‚ã‚ã‚Šã€8æœˆã„ã£ã±ã„ã§ä¸€æ—¦ã‚„ã‚ã«ã—ã‚ˆã†ã‹ãªã¨æ€ã„ã‹ã‘ã¦ã„ãŸã®ã§ã™ãŒã€æœˆæœ«ã®é€±ã«çªå…¥ã—ã¦è§£æ±ºã®å…†ã—ãŒè¦‹ãˆã¦ããŸã®ã§ã€ã‚‚ã†å°‘ã—ç²˜ã£ã¦ã¿ã‚ˆã†ã‹ã¨æ€ã„ã¾ã™ã€‚&lt;/p>
&lt;p>è¤‡æ•°å°æ§‹æˆã«ã—ãŸã‚‰10ä¸‡ç‚¹ã¾ã§å±Šãã®ã ã‚ã†ã‹&amp;hellip;&lt;/p>
&lt;p>ç¶šãã‚‚æ›¸ã‘ãŸã‚‰æ›¸ãã¾ã™ã€‚&lt;/p></description></item><item><title>ISUCON12äºˆé¸å‚åŠ ã—ãŸ</title><link>https://reiichii.github.io/post/2022-07-24-14/</link><pubDate>Sun, 24 Jul 2022 14:06:01 +0900</pubDate><guid>https://reiichii.github.io/post/2022-07-24-14/</guid><description>&lt;img src="https://reiichii.github.io/post/2022-07-24-14/score_graph.png" alt="Featured image of post ISUCON12äºˆé¸å‚åŠ ã—ãŸ" />&lt;p>ISUCON12äºˆé¸ã«å‚åŠ ã—ã¾ã—ãŸã€‚çµæœã¯æ•£ã€…ã ã£ãŸã®ã§ã™ãŒæŒ¯ã‚Šè¿”ã‚Šã‚‚å…¼ã­ã¦æ®‹ã—ã¦ãŠã“ã†ã¨æ€ã„ã¾ã™ã€‚&lt;/p>
&lt;blockquote class="twitter-tweet">&lt;p lang="ja" dir="ltr">ISUCON12 ã‚ªãƒ³ãƒ©ã‚¤ãƒ³äºˆé¸ã€17:00ã®æ™‚ç‚¹ã§ã‚¹ã‚³ã‚¢ã¯å‡çµã•ã‚Œã¾ã—ãŸğŸš€ æ®‹æ™‚é–“ 01:00:00ã®ã‚¹ã‚³ã‚¢ã¯ã“ã¡ã‚‰ï¼ &lt;a href="https://twitter.com/hashtag/isucon?src=hash&amp;amp;ref_src=twsrc%5Etfw">#isucon&lt;/a> &lt;a href="https://t.co/SGjrF9nBCR">pic.twitter.com/SGjrF9nBCR&lt;/a>&lt;/p>&amp;mdash; ISUCONå…¬å¼ (@isucon_official) &lt;a href="https://twitter.com/isucon_official/status/1550753842446630912?ref_src=twsrc%5Etfw">July 23, 2022&lt;/a>&lt;/blockquote>
&lt;script async src="https://platform.twitter.com/widgets.js" charset="utf-8">&lt;/script>
&lt;h2 id="ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹&lt;/h2>
&lt;ul>
&lt;li>åˆå‡ºå ´&lt;/li>
&lt;li>Python&lt;/li>
&lt;li>1äººãƒãƒ¼ãƒ &lt;/li>
&lt;li>2502ç‚¹&lt;/li>
&lt;/ul>
&lt;p>ç›®æ¨™ã¯ã€Œé—‡é›²ã«æ‰‹ã‚’å‹•ã‹ãšã«çˆªç—•æ®‹ã™ã€ã§ã—ãŸã€‚
çˆªç—•ã¯æ®‹ã›ã¾ã›ã‚“ã§ã—ãŸğŸª¦&lt;/p>
&lt;h2 id="æº–å‚™">æº–å‚™&lt;/h2>
&lt;p>ã‚„ã£ã¦ã„ãŸã“ã¨ã¨ã—ã¦ã¯ä»¥ä¸‹ã§ã™ã€‚&lt;/p>
&lt;ul>
&lt;li>ISUCON11äºˆé¸éå»å•è§£ã
&lt;ul>
&lt;li>alpã‚„mysqlã®slow query logãªã©ã®è¨ˆæ¸¬ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ã¦ãŠãã“ã¨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>6æœˆã«è¡Œã‚ã‚ŒãŸäº‹å‰è¬›ç¿’ã¨ãƒãƒ³ã‚ºã‚ªãƒ³ã¸ã®å‚åŠ 
&lt;ul>
&lt;li>æ™®æ®µrubyã•ã‚ã‚‰ãªã„ã®ã§å¤šå°‘ã‚„ã‚Šã«ãã‹ã£ãŸã®ã§ã™ãŒã€å‡ºã¦è‰¯ã‹ã£ãŸã§ã™ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ISUCONç”¨ansible playbookã‚’ç”¨æ„
&lt;ul>
&lt;li>è¨ˆæ¸¬ãƒ„ãƒ¼ãƒ«ã®å°å…¥ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«è¡Œã†ãŸã‚æº–å‚™ã—ã¦ã„ã¾ã—ãŸ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³">ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³&lt;/h2>
&lt;ul>
&lt;li>09:40~ é…ä¿¡è¦–è´
&lt;ul>
&lt;li>äºˆé¸å•é¡Œã®æ¦‚è¦ã‚’èã&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>10:00~ é–‹å§‹
&lt;ul>
&lt;li>ãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆä¸€é€šã‚Šè¦‹ã‚‹ï¼ˆæ„Ÿå‹•ã—ãŸï¼‰&lt;/li>
&lt;li>å½“æ—¥ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èª­ã‚€&lt;/li>
&lt;li>ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’èª­ã‚€&lt;/li>
&lt;li>èª­ã¿ãªãŒã‚‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è§¦ã£ãŸã‚Šã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚’æ›¸ã„ã¦ä»•æ§˜ã‚’æŠŠæ¡&lt;/li>
&lt;li>ã‚µãƒ¼ãƒã¸ã®sshæ¥ç¶šç¢ºèª&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>11:00~ æº–å‚™
&lt;ul>
&lt;li>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’gitç®¡ç†ä¸‹ã«ç½®ã&lt;/li>
&lt;li>åˆå›ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’å®Ÿè¡Œ&lt;/li>
&lt;li>ãƒ•ãƒ¯ãƒƒã¨æ”¹å–„ã®ç›®æ˜Ÿã‚’ã¤ã‘ã‚‹&lt;/li>
&lt;li>ã‚µãƒ¼ãƒæ§‹æˆã‚’mysqlç”¨ã‚µãƒ¼ãƒã¨applicationç”¨ã®2å°æ§‹æˆã«å¤‰æ›´ã™ã‚‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>12:00~ æº–å‚™
&lt;ul>
&lt;li>è¨ˆæ¸¬ãƒ„ãƒ¼ãƒ«ã®å°å…¥&lt;/li>
&lt;li>nginxã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’gitç®¡ç†ä¸‹ã«é…ç½®ã—ç›´ã™&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>13:00~13:30 ãŠæ˜¼ä¼‘æ†©
&lt;ul>
&lt;li>20åˆ†ã§ã”é£¯é£Ÿã¹ã¦10åˆ†æ˜¼å¯ã€‚ã‚‚ã†ã“ã®æ™‚ç‚¹ã§çµæ§‹ç–²ã‚Œã¦ã„ãŸ&lt;/li>
&lt;li>åˆå‰ä¸­ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ã»ã¨ã‚“ã©è¦‹ã‚Œã¦ã„ãªã„&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>13:30~ æº–å‚™ã®å»¶é•·æˆ¦
&lt;ul>
&lt;li>nginxã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–“é•ãˆã¦ãŠã‚Šã€ä¿®æ­£ç®‡æ‰€æ¢ã—ã«æ™‚é–“ã‚’æ½°ã™&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>14:00~ æ”¹å–„é–‹å§‹
&lt;ul>
&lt;li>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚³ãƒ¼ãƒ‰ã‚’çœºã‚ã‚‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>14:30~16:30 æ”¹å–„æ¡ˆ1.ã‚¹ãƒ­ã‚¦ã‚¯ã‚¨ãƒªã‚’æ½°ã™è©¦ã¿&lt;/li>
&lt;li>16:30~17:30 æ”¹å–„æ¡ˆ2.ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã®å¤šã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æ”¹å–„&lt;/li>
&lt;li>17:30~ æ”¹å–„æ¡ˆ3.bulkinsertã«æ›¸ãæ›ãˆã¦ã¿ã‚‹&lt;/li>
&lt;li>17:45~ å†èµ·å‹•ãƒã‚§ãƒƒã‚¯&lt;/li>
&lt;li>18:00~19:00 ç«¶æŠ€çµ‚äº†ãƒ»é…ä¿¡ã§è¬›è©•ã‚’èã&lt;/li>
&lt;/ul>
&lt;p>ã“ã†ã—ã¦æŒ¯ã‚Šè¿”ã£ã¦ã¿ã‚‹ã¨è¨ˆæ¸¬ãƒ„ãƒ¼ãƒ«ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«å°å…¥ã§ãã¦ã„ã‚Œã°+1hãã‚‰ã„ã‚³ãƒ¼ãƒ‰èª­ã‚€æ™‚é–“ã‚’æ»å‡ºã§ãã¦ã„ã¾ã—ãŸã­ã€‚ansibleã‚’ç”¨æ„ã—ã¦ã„ãŸãŒã¡ã‚‡ã“ã¡ã‚‡ã“å°ã•ã„ã‚¨ãƒ©ãƒ¼ã«ã¯ã¾ã£ã¦æ°—ãŒã¤ã„ãŸã‚‰1hã»ã©çµŒã£ã¦ã—ã¾ã£ã¦ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ä»Šå›ã®ç›®æ¨™ãŒé—‡é›²ã«æ‰‹ã‚’å‹•ã‹ã•ãªã„ã ã£ãŸã®ã§ã€ä¸€å¿œè‡ªåˆ†ãªã‚Šã«æ ¹æ‹ ã‚„ç‹™ã„ã‚’æŒã£ã¦ã„ãŸã¤ã‚‚ã‚Šã ã£ãŸã®ã§ã™ãŒã€è¬›è©•ã‚’èãæ„Ÿã˜çš„ãŒå¤–ã‚Œã¦ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;h3 id="æ”¹å–„æ¡ˆ0ã‚µãƒ¼ãƒã®å½¹å‰²åˆ†æ‹…">æ”¹å–„æ¡ˆ0.ã‚µãƒ¼ãƒã®å½¹å‰²åˆ†æ‹…&lt;/h3>
&lt;p>ã‚µãƒ¼ãƒæ§‹æˆã‚’mysqlç”¨ã‚µãƒ¼ãƒã¨applicationç”¨ã®2å°æ§‹æˆã«å¤‰æ›´ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>åˆå›ãƒ™ãƒ³ãƒå®Ÿè¡Œæ™‚ã«topã®å‡ºåŠ›ã‚’çœºã‚ã¦ã„ãŸã®ã§ã™ãŒã€dbã¨pythonãŒcpuã‚’é£Ÿã„æ½°ã—ã‚ã£ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆãŸãŸã‚ã€‚å…ˆã«åˆ†ã‘ãŸæ–¹ãŒä»Šå¾Œå¤‰åŒ–è¿½ã„ã‚„ã™ã„ã‹ãªã¨æ€ã£ãŸã¨ã„ã†ã®ã‚‚ã‚ã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>åˆ†ã‘ãŸã“ã¨ã«ã‚ˆã‚Š+500ç‚¹ã»ã©ã‚¹ã‚³ã‚¢ãŒæ”¹å–„ã—ã¾ã—ãŸã€‚goã‹ã‚‰pythonã«ã—ãŸã¨ãã«ä¸‹ãŒã£ãŸåˆ†ãŒå…ƒã«æˆ»ã£ãŸã ã‘ãªã®ã§å®Ÿè³ªãƒ—ãƒ©ãƒã‚¤0ã§ã™ã­ã€‚&lt;/p>
&lt;h3 id="æ”¹å–„æ¡ˆ1æ–™é‡‘é›†è¨ˆå‡¦ç†ã®ã‚¹ãƒ­ã‚¦ã‚¯ã‚¨ãƒªã‚’æ½°ã™è©¦ã¿">æ”¹å–„æ¡ˆ1.æ–™é‡‘é›†è¨ˆå‡¦ç†ã®ã‚¹ãƒ­ã‚¦ã‚¯ã‚¨ãƒªã‚’æ½°ã™è©¦ã¿&lt;/h3>
&lt;ul>
&lt;li>adminã¨orgç³»ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é…ç‚¹ãŒé«˜ã„ã“ã¨&lt;/li>
&lt;li>adminã®ä¸€è¦§ç”»é¢ã¨orgã®è«‹æ±‚æƒ…å ±ä¸€è¦§ç”»é¢ãŒç•°æ§˜ã«é‡ã‹ã£ãŸã“ã¨&lt;/li>
&lt;li>ã‚¹ãƒ­ã‚¦ã‚¯ã‚¨ãƒªãƒ­ã‚°ã§ä¸€ç•ªé‡ã‹ã£ãŸã‚¯ã‚¨ãƒªãŒã€ä¸Šè¨˜äºŒã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¯ã‚¨ãƒªã ã£ãŸã“ã¨&lt;/li>
&lt;/ul>
&lt;p>ã‹ã‚‰ã€ã“ã®å‡¦ç†ã‚’æ”¹å–„ã™ã‚Œã°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå¤§ããæ”¹å–„ã™ã‚‹ã®ã§ã¯ã¨ç€æ‰‹ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ãã‚Œè‡ªä½“ã¯è‰¯ã‹ã£ãŸã®ã§ã™ãŒã€ å‡¦ç†ãŒå‚ç…§ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿æºãŒmysqlã¨sqliteã«åˆ†ã‹ã‚Œã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ã©ã†ã—ãŸã‚‰è‰¯ã„ã‚‚ã®ã‹ã¨æ‰‹ãŒå‹•ã‹ãšã€‚sqliteã‚’mysqlã«è¼‰ã›æ›¿ãˆã‚‹ã¨ã„ã£ãŸé¸æŠè‚¢ã¯åŠ¹æœãŒè¦‹è¾¼ã‚ã‚‹ã‹ã©ã†ã‹åˆ†ã‹ã‚‰ãªã‹ã£ãŸã®ã§å®Ÿæ–½ã«è¸ã¿åˆ‡ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚&lt;/p>
&lt;p>mysqlå´ã®æ”¹å–„ã‚’ã—ã‚ˆã†ã¨æ¤œç´¢ä»¶æ•°ã‚’å¿…è¦ãªåˆ†ã ã‘ã«çµã£ãŸã‚Šã—ã¦ã„ãŸã®ã§ã™ãŒã€ãƒ™ãƒ³ãƒãƒãƒ¼ã‚«ãƒ¼ã«ã‚ˆã‚‹æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã—ã¾ã„ã¾ã—ãŸã€‚ã“ã®å‡¦ç†ã®æ”¹å–„ã«2hã»ã©ã‹ã‘ã¦ã—ã¾ã£ã¦ã„ãŸã®ã§ä¸­æ–­ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12-qualify/commit/855a3be79efea20a55c1bd6f6a04bb1f3d050d19" target="_blank" rel="noopener"
>ãƒ­ã‚°&lt;/a>&lt;/p>
&lt;h3 id="æ”¹å–„æ¡ˆ2-playerã®ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ä¸€è¦§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æ”¹å–„ã™ã‚‹è©¦ã¿">æ”¹å–„æ¡ˆ2. playerã®ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ä¸€è¦§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æ”¹å–„ã™ã‚‹è©¦ã¿&lt;/h3>
&lt;ul>
&lt;li>alpã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é›†è¨ˆã—ãŸã¨ã“ã‚åˆè¨ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒä¸€ç•ªå¤šã‹ã£ãŸã®ã¯playerã®ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ä¸€è¦§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã ã£ãŸã“ã¨&lt;/li>
&lt;li>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚«ãƒ¼ã®å‡ºåŠ›ã«ã€Œleaderboardã®è¡¨ç¤ºã«1ç§’ä»¥ä¸Šã‹ã‹ã£ãŸãŸã‚2äººã®å‚åŠ è€…ãŒé›¢è„±ã—ã¾ã—ãŸã€‚ã€ã®ã‚ˆã†ã«å‡ºã¦ã„ãŸã“ã¨&lt;/li>
&lt;/ul>
&lt;p>playerç³»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€å…ˆã»ã©ã®adminã‚„orgç³»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ç•°ãªã‚ŠåŠ ç®—ã¯å°‘ãªã„ã®ã§ã™ãŒã€ä¸Šè¨˜ã®ç†ç”±ã‹ã‚‰ã“ã“ã‚’æ”¹å–„ã™ã‚Œã°å°‘ãªãã¨ã‚‚ã‚¹ã‚³ã‚¢ãŒãã‚Œãªã‚Šã«æ”¹å–„ã•ã‚Œã‚‹è¦‹è¾¼ã¿ãŒã‚ã‚Šã¾ã—ãŸã€‚&lt;/p>
&lt;p>ãŸã å‚ç…§å…ˆãŒsqliteã®ãƒ‡ãƒ¼ã‚¿ã§ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ã£ã¦ã©ã†ã‚„ã‚‹ã‚“ã ã¨é¦–ã‚’æ»ã‚‹ç¾½ç›®ã«ã€‚èª¿ã¹ã¦ã¿ãŸã‚‰sqliteã«ã‚‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¦‚å¿µãŒã‚ã‚Šã€DBåˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®create table sqlè¦‹ãŸã¨ã“ã‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯è²¼ã‚‰ã‚Œã¦ã„ãªã‹ã£ãŸã®ã§è©¦ã—ã«è²¼ã£ã¦è¦‹ãŸã®ã§ã™ãŒã€ã»ã¨ã‚“ã©ã‚¹ã‚³ã‚¢ã«å½±éŸ¿ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚&lt;/p>
&lt;p>ã¾ã æ”¹å–„ã®ä½™åœ°ã¯ã‚ã£ãŸã®ã‹ã‚‚ã§ã™ãŒã€ã“ã®æ™‚ç‚¹ã§æ®‹ã‚Š1hã‚’åˆ‡ã£ã¦ã—ã¾ã£ã¦ã„ãŸãŸã‚ä¸€æ—¦æ·±è¿½ã„ã‚’ã‚„ã‚ã¦ã—ã¾ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12-qualify/commit/82167412532d0dd2e789c27afb5ed6187d427c3b" target="_blank" rel="noopener"
>ãƒ­ã‚°&lt;/a>&lt;/p>
&lt;h3 id="æ”¹å–„æ¡ˆ3-forã§insertã—ã¦ã„ã‚‹ç®‡æ‰€ã‚’bulkinsertã•ã›ã‚‹">æ”¹å–„æ¡ˆ3. forã§insertã—ã¦ã„ã‚‹ç®‡æ‰€ã‚’bulkinsertã•ã›ã‚‹&lt;/h3>
&lt;p>æ®‹ã‚Šæ™‚é–“ãŒå¾®å¦™ã ã£ãŸã®ã§ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰çœºã‚ã¦ã„ã‚‹ã¨ãã«æ°—ã«ãªã£ã¦ãŠã‚Šã€ã™ãã«æ”¹å–„ã§ããã†ãªç®‡æ‰€ã¨ã—ã¦ &lt;code>/api/organizer/players/add&lt;/code> ã®insertå‡¦ç†ã‚’æ›¸ãæ›ãˆã‚ˆã†ã¨æ€ã„ã¾ã—ãŸã€‚å®Ÿæ–½ã—ã¦è¦‹ãŸã‚‚ã®ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚«ãƒ¼ãŒã“ã‘ã¾ã—ãŸã€‚å˜ç´”ã«æ›¸ãæ›ãˆã‚‹ã ã‘ã ã¨å¾Œç¶šå‡¦ç†ãŒæ„å›³ã—ãŸå½¢ã«å‹•ã‹ãªã‹ããªã£ã¦ã—ã¾ã†ã“ã¨ã«å¾Œã‹ã‚‰æ°—ã¥ãã¾ã—ãŸã€‚&lt;/p>
&lt;p>ãã‚‚ãã‚‚ã‚¢ãƒ—ãƒ­ãƒ¼ãƒæ–¹æ³•ãŒé–“é•ãˆã¦ã„ãŸã®ã‹ã€å¾Œç¶šå‡¦ç†ã‚‚åˆã‚ã›ã¦ãªã‚“ã¨ã‹ã™ã‚‹ä½™åœ°ãŒã‚ã£ãŸã®ã‹ã€æ®‹ã‚ŠãŒ15åˆ†ã¨æ¤œè¨ã™ã‚‹æ™‚é–“ãŒã‚‚ã†ãªã‹ã£ãŸã®ã§ä¸­æ–­ã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12-qualify/commit/e9bc7671bb06d673cb8a4061841e457da5d236ac" target="_blank" rel="noopener"
>ãƒ­ã‚°&lt;/a>&lt;/p>
&lt;h2 id="å•é¡Œã®æ‰€æ„Ÿ">å•é¡Œã®æ‰€æ„Ÿ&lt;/h2>
&lt;ul>
&lt;li>ã€Œmysqlã§æº–å‚™ã—ã¦ã„ãŸã‹ã‚‰postgresqlã¨ã‹ã ã£ãŸã‚‰ãã¤ã„ãª..ã¾ã‚ã‚¹ãƒãƒ³ã‚µãƒ¼ã«mysqlãŒã„ã‚‹ã‹ã‚‰ãªã„ã‹ã€ã¨ã‹æ€ã£ã¦ã„ãŸã‚‰ã¾ã•ã‹ã®mysql+sqliteã§ã³ã£ãã‚Š&lt;/li>
&lt;li>auto_incrementã®ã¨ã“ã‚ã‚‚ä½•ã‹å¤‰ãªã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ãªãã¨ã¯æ€ã£ã¦ã„ãŸã®ã§ã™ãŒã€æ–™é‡‘è¡¨ã¨ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰è¡¨ç¤ºã®ç®‡æ‰€ã«ã°ã‹ã‚Šæ°—ã‚’å–ã‚‰ã‚Œã¦ã„ãŸã®ã§å…¨ç„¶è¦‹ã‚Œã¾ã›ã‚“ã§ã—ãŸ&lt;/li>
&lt;li>è¬›è©•ã§ã€Œã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è²¼ã‚Œã°dbã®è² è·ãŒã²ã¨ã¾ãšã¯ä¸‹ãŒã‚‹ã€ã‚ˆã†ãªã“ã¨ãŒè¨€ã‚ã‚Œã¦ã„ã¦ã€ã‚‚ã†å°‘ã—DBå‘¨ã‚Šã‚’é‡ç‚¹çš„ã«ç¢ºèªã™ã‚Œã°è‰¯ã‹ã£ãŸã§ã™ã€‚è¦‹ã¦ã„ãŸç®‡æ‰€ã®ã‚¯ã‚¨ãƒªã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ç¢ºèªã—ã¦ã„ãŸã¤ã‚‚ã‚Šã ã£ãŸã®ã§ã™ãŒãã†ã§ã¯ãªãã€å‡ºã¦ããŸã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªã«å¯¾ã—ã¦ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåŠ¹ã„ã¦ã„ã‚‹ã‹ã‚’è¦‹ã¦ãŠãã¹ãã§ã—ãŸ&lt;/li>
&lt;li>lockãŒã‚„ãŸã‚‰å¤šã„ã®ã‚‚æ°—ã«ã¯ãªã£ã¦ã„ãŸã®ã§ã™ãŒã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ç®‡æ‰€ã¨ã„ã†ã®ãŒå‡ºã¦ãã¾ã›ã‚“ã§ã—ãŸã€‚ãŸã ã®çŸ¥è¦‹ä¸è¶³ã§ã™&lt;/li>
&lt;li>ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å›³ã‚’æ›¸ã„ã¦ã„ãŸã®ã§ã™ãŒã€ã‚¢ãƒ—ãƒªã®å…¨ä½“åƒã‚’ç¶²ç¾…çš„ã«æŠŠæ¡ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã—ãŸã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨dbã®ã‚„ã‚Šã¨ã‚Šå‘¨ã‚Šã‚‚ä½•ã‹ã—ã‚‰ã®æ–¹æ³•ã§ã‚¹ãƒ ãƒ¼ã‚ºã«æŠŠæ¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚Œã‚‹ã¨è‰¯ã‹ã£ãŸã®ã§ã™ãŒ&lt;/li>
&lt;/ul>
&lt;h2 id="ãã®ä»–æ„Ÿæƒ³">ãã®ä»–æ„Ÿæƒ³&lt;/h2>
&lt;ul>
&lt;li>ISUCON11äºˆé¸å•é¡Œã‚’è§£ã„ã¦ã„ãŸæ™‚ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½¿ç”¨ã®ä»•æ§˜ãŒé›£ã—ãã€ä½•ã‚„ã£ã¦ã„ã„ã‹å…¨ãåˆ†ã‹ã‚‰ãªã„çŠ¶æ…‹ã§ã—ãŸã€‚ãã‚Œã«æ¯”ã¹ãŸã‚‰ä»Šå›ã®å•é¡Œã¯ã¾ã ãã®è¾ºã‚Šã®æŠŠæ¡ã¯ã—ã‚„ã™ã‹ã£ãŸã§ã™&lt;/li>
&lt;li>ãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆãŒã©ã‚“ãªã‚‚ã®ã‹ãšã£ã¨è¦‹ã¦ã¿ãŸã‹ã£ãŸã®ã§æ„Ÿå‹•ã—ã¾ã—ãŸã€‚çµ‚ã‚ã£ãŸå¾Œé€Ÿæ”»ã§é¸æ‰‹ç”¨ãƒšãƒ¼ã‚¸ãŒè¦‹ã‚Œãªããªã£ã¦ã—ã¾ã„ã€ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã®ãƒ­ã‚°ã‚„ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚¹ã‚¯ã‚·ãƒ§ã‚’å–ã‚Šæã­ã¦ã—ã¾ã„ã¾ã—ãŸ&lt;/li>
&lt;li>çµ‚ã‚ã£ãŸå¾Œçœ¼ç²¾ç–²åŠ´ã§ããŸããŸã§ã€é€Ÿæ”»ã§pcé–‰ã˜ã¦ã—ã¾ã£ãŸã®ã§ã™ãŒã€DCã®æ–¹ã§ã¯æ„Ÿæƒ³æˆ¦ã§ç››ã‚Šä¸ŠãŒã£ã¦ã„ã¦ä»–ã®å‚åŠ è€…ã®ãƒã‚¤ã‚¿ãƒªãƒ†ã‚£ã®é«˜ã•ã‚’æ„Ÿã˜ã¾ã—ãŸã€‚ç¿Œæœèª­ã¿è¿”ã—ã¦ã„ã¦é¢ç™½ãã€å¾©ç¿’æ™‚ã®å‚è€ƒã«ã¾ãŸèª­ã¿è¿”ãã†ã¨æ€ã„ã¾ã™&lt;/li>
&lt;li>é›†ä¸­åŠ›ã¯8hæ„å¤–ã¨æŒã¡ã¾ã—ãŸã€‚1h~1h30minã«ã¤ã5minã®ä¼‘æ†©ã‚’ç„¡ç†ã‚„ã‚Šè¨­ã‘ã‚‹ã‚ˆã†ã«ã—ã¦è‰¯ã‹ã£ãŸã§ã™&lt;/li>
&lt;/ul>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>ç„¡å¿µ : æ¥½ã—ã‹ã£ãŸï¼ ãŒ 6:4ã®æ°—æŒã¡ã§ã™ã€‚&lt;/p>
&lt;p>ã‚ã¨ç›®ã¨æ‰‹ã¨é ­ãŒè¶³ã‚Šãªã„ã§ã™ã€‚æœ¬æˆ¦ä¸€äººå‡ºå ´ã—ã¦ã„ã‚‹äººã®å‡„ã•ã‚’å®Ÿæ„Ÿã—ã¾ã™ã€‚ç§ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§ã‚‚ã†å°‘ã—ã¾ã¨ã‚‚ã«æˆ¦ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‰ã€æ¬¡å›ã¯èª°ã‹èª˜ã£ã¦ã¿ã‚‹ã®ã‚‚ã‚ã‚Šã‹ã‚‚ãªã¨æ€ãˆã¦ã—ã¾ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ä»Šå¹´ã‚‚Pythonã§ã®æœ¬æˆ¦å‡ºå ´é¸æ‰‹ã¯å‡ºãªã‹ã£ãŸã®ã§Pythonã§ç‹™ã„ãŸã„ãªã¨æ€ã†åé¢ã€æ¥­å‹™ã§è§¦ã‚‰ãªã„goã®å‹‰å¼·ã®å£å®Ÿã«ã—ãŸã„ã¨ã„ã†æ°—æŒã¡ã®ãŒå¼·ã„ã®ã§ã€æ¥å¹´ã¯goã§10000ç‚¹ä»¥ä¸Šå‡ºã™ã“ã¨ã‚’ç›®æ¨™ã«å‡ºã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ãƒ™ãƒ³ãƒãƒãƒ¼ã‚«ãƒ¼ãŒgoã§æ›¸ã‹ã‚Œã¦ã„ã¦ã€ãã®è¾ºã‚Šã®å‡¦ç†ã‚‚ã‚‚ã†å°‘ã—èª­ã‚ã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„ã‚“ã§ã™ã‚ˆã­ã€‚&lt;/p>
&lt;p>é‹å–¶ã®çš†æ§˜ã€é–‹å‚¬ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12-qualify" target="_blank" rel="noopener"
>https://github.com/reiichii/isucon12-qualify&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/reiichii/isucon12-qualify/issues/1" target="_blank" rel="noopener"
>è¨ˆæ¸¬ãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://reiichii.github.io/post/2022-07-24-14/score_graph.png"
width="2336"
height="1122"
srcset="https://reiichii.github.io/post/2022-07-24-14/score_graph_hu1c45c6ba752b88bcb48fca24fcaa2fcb_322845_480x0_resize_box_3.png 480w, https://reiichii.github.io/post/2022-07-24-14/score_graph_hu1c45c6ba752b88bcb48fca24fcaa2fcb_322845_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="ä¸Šã’ã‚‰ã‚Œãªã‹ã£ãŸ"
class="gallery-image"
data-flex-grow="208"
data-flex-basis="499px"
>&lt;/p>
&lt;p>&lt;img src="https://reiichii.github.io/post/2022-07-24-14/usecase.jpg"
width="4032"
height="3024"
srcset="https://reiichii.github.io/post/2022-07-24-14/usecase_hu8aac09e64bc6d0d3413f56a86150a826_1612266_480x0_resize_q75_box.jpg 480w, https://reiichii.github.io/post/2022-07-24-14/usecase_hu8aac09e64bc6d0d3413f56a86150a826_1612266_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
alt="ã“ã‚“ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã—ãŸ(?)"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="320px"
>&lt;/p></description></item><item><title>ISUCON11-qualifyã®ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ãŒé–‹ã‹ãªã‹ã£ãŸ</title><link>https://reiichii.github.io/post/2022-07-13-22/</link><pubDate>Wed, 13 Jul 2022 22:21:31 +0900</pubDate><guid>https://reiichii.github.io/post/2022-07-13-22/</guid><description>&lt;p>ISUCON11äºˆé¸ç’°å¢ƒæ§‹ç¯‰æ™‚ã€æ§‹ç¯‰ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€Œã“ã®ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã¾ãŸé·ç§»å…ˆurlãŒã€Œ&lt;code>http://localhost:5000/?callback=https://isucondition.t.isucon.dev&lt;/code>ã€ã®ã‚ˆã†ã«ãŠã‹ã—ãªè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚&lt;/p>
&lt;p>å‰æã¨ã—ã¦ä»¥ä¸‹ã®æ‰‹é †ã‚’å‚è€ƒã«ã€ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã—ã€ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãŒé–‹ã‘ã‚‹ã¨ã“ã‚ã¾ã§ã‚’ç¢ºèªæ¸ˆã¿ã§ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://knowledge.sakura.ad.jp/31520/" target="_blank" rel="noopener"
>ISUCONéå»å•é¡Œã®ç’°å¢ƒã‚’ã€Œã•ãã‚‰ã®ã‚¯ãƒ©ã‚¦ãƒ‰ã€ã§æ§‹ç¯‰ã™ã‚‹ | ã•ãã‚‰ã®ãƒŠãƒ¬ãƒƒã‚¸&lt;/a>&lt;/p>
&lt;h2 id="ã‚„ã‚‹ã“ã¨1-jia-api-mockã‚’èµ·å‹•ã™ã‚‹">ã‚„ã‚‹ã“ã¨1. JIA API Mockã‚’èµ·å‹•ã™ã‚‹&lt;/h2>
&lt;p>&lt;a class="link" href="https://github.com/isucon/isucon11-qualify/blob/main/docs/isucondition.md#jia-api-mock-%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6" target="_blank" rel="noopener"
>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ‹ãƒ¥ã‚¢ãƒ«&lt;/a>ã®æœ«å°¾ã«æ›¸ã„ã¦ã‚ã‚‹ã®ã§ã™ãŒã€ã‚µãƒ¼ãƒã®5000portã§ä¸€éƒ¨ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å¾…ã¡å—ã‘ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚&lt;/p>
&lt;p>å®Ÿéš›urlã‹ã‚‰ã‚‚åˆ†ã‹ã‚‹é€šã‚Šã€apiã®ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«5000portã«é£›ã°ã™ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚è©²å½“ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã§ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/isucon/isucon11-qualify/blob/main/webapp/frontend/src/components/Home/Auth.tsx#L6" target="_blank" rel="noopener"
>https://github.com/isucon/isucon11-qualify/blob/main/webapp/frontend/src/components/Home/Auth.tsx#L6&lt;/a>&lt;/p>
&lt;p>è‡ªå‹•èµ·å‹•ã¯ã—ãªã„ãŸã‚ã€ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«æ›¸ã„ã¦ã‚ã‚‹æ‰‹é †ã§ãƒ¢ãƒƒã‚¯ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•ã—ã¦ã‚ã’ã¾ã™ã€‚&lt;/p>
&lt;h2 id="ã‚„ã‚‹ã“ã¨2-ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®è¨­å®š">ã‚„ã‚‹ã“ã¨2. ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®è¨­å®š&lt;/h2>
&lt;p>ã“ã®ã¾ã¾ã ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã—ãŸéš›ã«ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®ã€Œlocalhost:5000ã€ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®5000ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚ŒãŸã‚‰ã€ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒã®5000ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ã‚ˆã†ã«ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®è¨­å®šã‚’ã—ã¦ãŠãã¾ã™ã€‚&lt;/p>
&lt;p>&lt;code>ssh -A -L 5000:{ip}:5000 {user}@{ip}&lt;/code>&lt;/p>
&lt;p>sshæ¥ç¶šã—ãŸçŠ¶æ…‹ã§ã€ŒJIAã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã€ã‚’æŠ¼ã™ã¨ã€ã€ŒSign in with JIAã€ã®ç”»é¢ãŒé–‹ãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ç”»é¢ã«ã™ã™ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ğŸ‘&lt;/p>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>åˆ†ã‹ã‚‹äººã«ã¯åˆ†ã‹ã‚‹ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã“ã‚Œã¯æ§‹ç¯‰æ‰‹é †æ›¸ã«èª¬æ˜ãŒã‚ã£ãŸæ–¹ãŒè¦ªåˆ‡ãªã‚ˆã†ãªæ°—ãŒã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ã¡ãªã¿ã«ã“ã®è¾ºã®ä»•æ§˜ã«ã¤ã„ã¦è©±ã•ã‚Œã¦ã„ã‚‹issueã‚‚ç™ºè¦‹ã—ã¾ã—ãŸã€‚å®Œå…¨ã«ç†è§£ã¯ã—ã¦ã„ã¾ã›ã‚“..ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/isucon/isucon11-qualify/issues/1260" target="_blank" rel="noopener"
>https://github.com/isucon/isucon11-qualify/issues/1260&lt;/a>&lt;/p></description></item><item><title>ISUCON12äº‹å‰è¬›ç¿’</title><link>https://reiichii.github.io/post/2022-06-07-20/</link><pubDate>Tue, 07 Jun 2022 20:56:13 +0900</pubDate><guid>https://reiichii.github.io/post/2022-06-07-20/</guid><description>&lt;p>ISUCONãƒãƒ³ã‚ºã‚ªãƒ³ç›®çš„ã§ç”³ã—è¾¼ã‚“ã ã®ã§ã™ãŒã€å»å¹´ä¸€æ˜¨å¹´ã®äº‹å‰è¬›ç¿’ãƒ¬ãƒãƒ¼ãƒˆã«ã¯æ›¸ã„ã¦ã„ãªã„å†…å®¹ãŒç››ã‚Šè¾¼ã¾ã‚Œã¦ã„ã¦æ™®é€šã«æ¥½ã—ã‹ã£ãŸã§ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://speakerdeck.com/rosylilly/isucon12-shi-qian-jiang-xi" target="_blank" rel="noopener"
>ISUCON12 äº‹å‰è¬›ç¿’ - Speaker Deck&lt;/a>&lt;/p>
&lt;p>ã»ã¼è³‡æ–™ã«æ›¸ã„ã¦ã‚ã‚‹ã®ã§ã™ãŒã€è¨˜å¿µã«æ‰‹å…ƒã®ãƒ¡ãƒ¢ã‚‚æ®‹ã—ã¾ã™ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>## å¼·ã„ãƒãƒ¼ãƒ ãŒã—ã¦ã„ã‚‹ã“ã¨
* ãªã‚“ã¨ãªãã§æ‰‹ã‚’å‹•ã‹ã•ãªã„ã€‚
- å„ªå‹è€…ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼ã§ã€Œä½•ãŒåŠ¹ã„ãŸã®ã‹ã‚ã‹ã‚‰ãªã„ã€ã¨ã„ã†ãƒãƒ¼ãƒ ã¯ã„ãªã„
* ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ ã‚’ã«1åˆ†ä»¥ä¸Šã‹ã‘ãªã„
- GUIã§gitæ“ä½œã—ãŒã¡ãªã”æ™‚ä¸–ã ã‘ã©ã€gitã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ãŸæ–¹ãŒã„ã„ã‚ˆ
* ä½¿ã„æ…£ã‚ŒãŸãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®configã‚’1ã‹ã‚‰æ›¸ã‹ãªã„
- äº‹å‰ã«ç”¨æ„ã—ã¦ãŠã
* ã‚„ã£ãŸã“ã¨ãŒãªã„ã“ã¨ã‚’ã‚„ã‚‰ãªã„
- å¤§ä¼šä¸­ã«å®Ÿå‹™ã§è§¦ã£ã¦ã„ãªã„goã«ç§»æ¤ã—ã‚ˆã†ã¨ã—ã¦ãƒœãƒ­è² ã‘ã—ãŸçµŒé¨“ãŒã‚ã‚‹
&lt;/code>&lt;/pre>&lt;p>ãªã‚“ã¨ãªãæ‰‹ã‚’å‹•ã‹ã™ãªã€ä»®èª¬ã‚’ãƒ™ãƒ¼ã‚¹ã«å‹•ãã“ã¨ã¯ISUCONä»¥å¤–ã®ä»•äº‹ã§ã‚‚è¨€ãˆã‚‹ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>## ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
10:00
* ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã¨ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èª­ã‚€
* ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¦‹ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŠŠæ¡ã™ã‚‹
* å„ã‚³ãƒ³ãƒãƒ¼ãƒˆãƒãƒ³ãƒˆãŒã©ã†èµ·å‹•ã•ã‚Œã¦ã„ã‚‹ã‹ã€è¨­å®šã‚„configã®å ´æ‰€ã‚’ç¢ºèª
- init.dã‹systemcnfã‹dockerã‹ãªã©
* è‡ªåˆ†ãŒå¿…è¦ãªruntimeã‚’ã•ã£ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠã
* dbã‚¹ã‚­ãƒ¼ãƒãŒã©ã†å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹èª¿ã¹ã‚‹
* ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã‚’æ§‹ç¯‰ã™ã‚‹
* ä½¿ã‚ã‚Œã¦ã„ã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ç¨®é¡ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’èª¿ã¹ã‚‹
- éå»ã«memcacheã‹ã¨æ€ã£ãŸã‚‰memcacheã®plaginã‚’å…¥ã‚ŒãŸmysqlã§ãã‚ŒãŒã™ã”ãé‡ã„ã€ã¨ã„ã†ç½ ãŒã‚ã£ãŸã‚‰ã—ã„
* ä½¿ã£ã¦ã„ã‚‹ã‚µãƒ¼ãƒã®ã‚¹ãƒšãƒƒã‚¯ã‚’å„å°èª¿æŸ»ã™ã‚‹
- ã‚µãƒ¼ãƒã«ã‚ˆã£ã¦ã‚¹ãƒšãƒƒã‚¯ãŒç•°ãªã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹
* ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹
11:00
* å¾—ç‚¹æºãŒä½•ã‹ã‚’ç¢ºèªã™ã‚‹
* æ¸›ç‚¹ã®è¦å› ã‚’æŠŠæ¡ã™ã‚‹
* ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã‚’å…¥ã‚Œã‚‹
* åˆæœŸçŠ¶æ…‹ã®å®Œå…¨ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆã™ã‚‹
- tarã§å›ºã‚ã¦ãŠã
12:00
* ã¡ã‚ƒã‚“ã¨ã”é£¯ã‚’é£Ÿã¹ã‚‹
* ã‚ã‹ã‚‰ãªã„ã“ã¨ãŒå‡ºãŸã‚‰ãƒªã‚¹ãƒˆã«ã—ã¦ãŠã
* ã‚„ã‚‹ã“ã¨ã€ã‚„ã‚‰ãªã„ã“ã¨ã‚’æ˜ç¢ºã«ã™ã‚‹
13:00
* ãƒ‡ãƒ—ãƒ­ã‚¤ãŒ1ã‚³ãƒãƒ³ãƒ‰ã§ã§ãã‚‹ã‚ˆã†ã«
* ãƒ‡ãƒ—ãƒ­ã‚¤â†’æ€§èƒ½è¨ˆæ¸¬â†’ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¾ã§ä¸€æ°—é€šè²«ã§è¡Œãˆã‚‹ä»•çµ„ã¿ã‚’ç”¨æ„ã—ã¦ãŠã
- line_profile
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆå˜ä½ã€€ã©ã¡ã‚‰ã‚‚
14:00~17:00
* 1ã‚³ãƒŸãƒƒãƒˆ1ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
* æ°—ã«ã™ã‚‹æŒ‡æ¨™ã‚’æ˜ç¢ºã«æŠŠæ¡ã—ã¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã™ã‚‹
17:00
* å†èµ·å‹•è©¦é¨“ã‚’ã™ã‚‹
* apmã‚’å…¥ã‚Œã¦ã„ãŸã‚‰åœæ­¢ã™ã‚‹
- newrelicã®apmæ­¢ã‚ã‚‹ã®æ„å¤–ã¨é›£ã—ã‹ã£ãŸã‚Šã™ã‚‹
* ãƒ‡ãƒãƒƒã‚¯ãƒ­ã‚°ã®å‡ºåŠ›ã‚’æ­¢ã‚ã‚‹
* ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã«å·®ã—è¾¼ã‚“ã ã‚‚ã®ã‚’æ­¢ã‚ã‚‹
18:00
* ä½œæ¥­ãƒ­ã‚°ã‚’ãƒ–ãƒ­ã‚°ã«æ›¸ãæº–å‚™ã‚’ã™ã‚‹
* è¨˜æ†¶ãŒæ˜ç¢ºãªé–“ã«æŒ¯ã‚Šè¿”ã‚Šã‚’ã™ã‚‹
&lt;/code>&lt;/pre>&lt;p>å„ªå‹çµŒé¨“ãƒãƒ¼ãƒ ã®è¡Œå‹•ã‚’ãƒˆãƒ¬ã‚¹ã—ãŸã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã¯ã€è€ƒãˆæ–¹ãªã©å‚è€ƒã«ã§ãã‚‹ã¨ã“ã‚ãŒå¤šã„è²´é‡ãªè³‡æ–™ã§ã™ã€‚&lt;/p>
&lt;p>å‰ã«ISUCON11äºˆé¸éå»å•ã«æŒ‘æˆ¦ã—ãŸæ™‚ã€ç§ã®å ´åˆãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã¨ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èª­ã‚€ã ã‘ã§1æ™‚é–“ã¯ã‹ã‹ã£ãŸã®ã§10:00ä»£ãã£ã£ã£ã¤ã¦æ€ã„ãªãŒã‚‰èã„ã¦ã„ã¾ã—ãŸğŸ™‚&lt;/p>
&lt;pre tabindex="0">&lt;code>### ãŠã™ã™ã‚ã®ç·´ç¿’
* ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- ãƒªãƒã‚¸ãƒˆãƒªä½œã£ã¦ã€git initã—ã¦ã€ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã—ã¦ã€deploy
* ansibleã‚’æœ€é€Ÿã§å›ã›ã‚‹ã‚ˆã†ã«ãªã£ã¦ãŠã
* ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‹ã‚‰é›†è¨ˆã‚’1ã‚³ãƒãƒ³ãƒ‰ã§ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
- é›†è¨ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œã£ã¦ãŠã
* ã‚µãƒ¼ãƒã®å½¹å‰²å¤‰æ›´
- èµ·å‹•ã‚’æ­¢ã‚ã‚‹(systemctlãªã‚‰disableã—å¿˜ã‚Œãªã„)ã€æ¥ç¶šå…ˆã‚’å¤‰æ›´ã™ã‚‹
* ä½¿ã„ãŸã„ãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ä½¿ã„ãŸã„ãƒ„ãƒ¼ãƒ«ã¯ä¸€ç™ºã§å…¥ã‚Œã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹(alp,pt-query-digest)
- prebuilt binaryãŒç”¨æ„ã§ãã‚‹ãªã‚‰ç”¨æ„ã™ã‚‹ã®ã‚‚æ‰‹
&lt;/code>&lt;/pre>&lt;p>ã‚‚ã—ä»Šå¹´å‡ºã‚Œã‚‹ãªã‚‰ã€æœ€ä½é™ã“ã‚Œã ã‘ã¯æº–å‚™ã—ã¦ã„ããŸã„ã€‚&lt;/p>
&lt;p>ã¾ãŸæœ€å¾Œã«åŒã˜å•é¡Œ5å›ãã‚‰ã„è§£ãã¨ã€æ–°ã—ã„ç™ºè¦‹ãŒã‚ã£ã¦æ¥½ã—ã„ã‚ˆã¨ã„ã£ãŸã“ã¨ã‚‚ã‚ã£ã¦ã€ã¾ãŸéå»å•è§£ãç›´ãã†ã¨æ€ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;p>ã¡ãªã¿ã«ã¾ã å‚åŠ ç”³ã—è¾¼ã¿ã§ãã¦ã„ã¾ã›ã‚“orz&lt;/p></description></item><item><title>ã‚­ãƒ¼ãƒãƒƒãƒ—å¤‰æ›´ã™ã‚‹æ™‚ã®æ‰‹é †</title><link>https://reiichii.github.io/post/2022-06-05-16/</link><pubDate>Sun, 05 Jun 2022 16:19:27 +0900</pubDate><guid>https://reiichii.github.io/post/2022-06-05-16/</guid><description>&lt;img src="https://reiichii.github.io/post/2022-06-05-16/img_keymap.png" alt="Featured image of post ã‚­ãƒ¼ãƒãƒƒãƒ—å¤‰æ›´ã™ã‚‹æ™‚ã®æ‰‹é †" />&lt;p>&lt;img src="https://reiichii.github.io/post/2022-06-05-16/img_keymap.png"
width="720"
height="720"
srcset="https://reiichii.github.io/post/2022-06-05-16/img_keymap_hu50b55d9f2e639c377323533322f7b495_75174_480x0_resize_box_3.png 480w, https://reiichii.github.io/post/2022-06-05-16/img_keymap_hu50b55d9f2e639c377323533322f7b495_75174_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="æ–°ã—ã„ã‚­ãƒ¼ãƒãƒƒãƒ—ã€‚å¤§ä½“ç«¯ã®ã‚‚ã®ã‚’çœŸã‚“ä¸­ã«å¯„ã›ã¦ã„ã‚‹ã ã‘"
class="gallery-image"
data-flex-grow="100"
data-flex-basis="240px"
>&lt;/p>
&lt;p>1å¹´ã»ã©å‰ã«ã“ã—ã‚‰ãˆãŸè‡ªä½œã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã§pcä½œæ¥­ã‚’è¡Œãªã£ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>ä¹…ã—ã¶ã‚Šã«ã‚­ãƒ¼ãƒãƒƒãƒ—ã‚’å¤‰ãˆã‚ˆã†ã¨æ€ã£ãŸã‚‰ã³ã£ãã‚Šã™ã‚‹ãã‚‰ã„ã‚„ã‚Šæ–¹ã‚’å¿˜ã‚Œã¦ãŠã‚Šã€æ€ã„å‡ºã™ã®ã«çµæ§‹æ™‚é–“ãŒæ›ã‹ã£ãŸãŸã‚æœªæ¥ã®è‡ªåˆ†ç”¨ã«å¿˜å‚™éŒ²ã¨ã—ã¦ã‚„ã‚Šæ–¹ã‚’æ®‹ã—ã¦ãŠãã¾ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://reiichii.hateblo.jp/entry/2021/05/04/210513" target="_blank" rel="noopener"
>ã€è‡ªä½œã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã€‘Sparrow62ã‚’çµ„ã¿ç«‹ã¦ãŸ&lt;/a>&lt;/p>
&lt;h2 id="ã‚„ã‚‹ã“ã¨">ã‚„ã‚‹ã“ã¨&lt;/h2>
&lt;ul>
&lt;li>ã‚­ãƒ¼ãƒãƒƒãƒ—ã®è¨­è¨ˆ&lt;/li>
&lt;li>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®firmwareã«æ›¸ãè¾¼ã‚€&lt;/li>
&lt;/ul>
&lt;h3 id="ã‚­ãƒ¼ãƒãƒƒãƒ—ã®è¨­è¨ˆ">ã‚­ãƒ¼ãƒãƒƒãƒ—ã®è¨­è¨ˆ&lt;/h3>
&lt;p>ã‚­ãƒ¼ãƒãƒƒãƒ—ã®è¨­è¨ˆã¯ã€&lt;a class="link" href="https://config.qmk.fm/#/sparrow62/LAYOUT" target="_blank" rel="noopener"
>QMK Configurator&lt;/a>ã¨ã„ã†Webã‚¢ãƒ—ãƒªã‹ã‚‰GUIã§è¡Œã„ã¾ã™ã€‚&lt;/p>
&lt;ol>
&lt;li>å‰ã®è¨­å®šã‚’èª­ã¿è¾¼ã¾ã›ã‚‹
&lt;ul>
&lt;li>KEYBOARDã‚’è‡ªåˆ†ãŒä½¿ã£ã¦ã„ã‚‹ã‚‚ã®ã«é¸æŠã™ã‚‹&lt;/li>
&lt;li>urlã‹ã‚‰jsonã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã—ã€keymap.jsonï¼ˆä»¥å‰ã®è¨­å®šæ™‚ã«exportã—ã¦ãŠã„ãŸã‚‚ã®ï¼‰ã®rowãƒ•ã‚¡ã‚¤ãƒ«ã®urlã‚’èª­ã¿è¾¼ã¾ã›ã‚‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç”»é¢ã½ã¡ã½ã¡ã§ã‚­ãƒ¼ãƒãƒƒãƒ—ã®é…ç½®ã‚’å¤‰æ›´ã™ã‚‹&lt;/li>
&lt;li>å³ä¸Šã®COMPILEãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã™ã‚‹&lt;/li>
&lt;li>å³ä¸‹ã®FIRMWAREãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã—ã€hexãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹&lt;/li>
&lt;/ol>
&lt;p>å¾Œã®ä½œæ¥­ã®ãŸã‚ã«ã€ã“ã®ç”»é¢ã¯ã¾ã é–‰ã˜ãªã„ã§ãŠãã€‚&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a class="link" href="https://salicylic-acid3.hatenablog.com/entry/qmk-configurator" target="_blank" rel="noopener"
>ï¼ˆåˆå¿ƒè€…ç·¨ï¼‰QMK Configuratorã‚’ä½¿ã£ã¦ã‚­ãƒ¼ãƒãƒƒãƒ—ã‚’æ›¸ãæ›ãˆã‚ˆã† - è‡ªä½œã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ¸©æ³‰è¡—ã®æ­©ãæ–¹&lt;/a>&lt;/p>
&lt;h3 id="ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®firmwareã«æ›¸ãè¾¼ã‚€">ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®firmwareã«æ›¸ãè¾¼ã‚€&lt;/h3>
&lt;p>ãƒ­ãƒ¼ã‚«ãƒ«PCã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®QMK Toolboxã«å…ˆã»ã©ã®hexãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¾ã›ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®firmwareã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã¯å·¦å³ç¹‹ã’ãŸã¾ã¾ã«ã—ã¦ã€å·¦å³ãã‚Œãã‚Œã«æ›¸ãè¾¼ã¿ã‚’ã—ã¾ã™ã€‚&lt;/p>
&lt;ol>
&lt;li>QMK Toolboxã‚’é–‹ã&lt;/li>
&lt;li>å…ˆã»ã©ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸhexãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¾ã›ã‚‹&lt;/li>
&lt;li>autoreloadã«ãƒã‚§ãƒƒã‚¯ã‚’ã™ã‚‹&lt;/li>
&lt;li>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’1åº¦æŠ¼ä¸‹ã™ã‚‹
&lt;ul>
&lt;li>æ›¸ãè¾¼ã¿ãŒå§‹ã¾ã‚Šã€ã€Œdone. thank you. disconnectã€ã®æ–‡è¨€ãŒå‡ºãŸã‚‰ç„¡äº‹æˆåŠŸ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åå¯¾ã®ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã«ã‚±ãƒ¼ãƒ–ãƒ«ã‚’å·®ã—ã€3ã¨4ã‚’è¡Œã†&lt;/li>
&lt;/ol>
&lt;p>QMK Configuratorã®TEST KEYBOARDã§ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®ãƒœã‚¿ãƒ³ã«æ„å›³ã—ãŸå¤‰æ›´ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a class="link" href="https://salicylic-acid3.hatenablog.com/entry/qmk-toolbox" target="_blank" rel="noopener"
>ï¼ˆåˆå¿ƒè€…ç·¨ï¼‰è‡ªä½œã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã«ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’æ›¸ãè¾¼ã‚€ - è‡ªä½œã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ¸©æ³‰è¡—ã®æ­©ãæ–¹&lt;/a>&lt;/p>
&lt;h3 id="å¾Œç‰‡ä»˜ã‘">å¾Œç‰‡ä»˜ã‘&lt;/h3>
&lt;ul>
&lt;li>QMK Configuratorã§jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’exportã—ã¦ãŠãï¼ˆæ¬¡å›ã¾ãŸèª­ã¿è¾¼ã¾ã›ã‚‹ãŸã‚ï¼‰&lt;/li>
&lt;li>PRINT KEYMAPã§ç”»åƒã‚’ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦ãŠãï¼ˆç¨€ã«ãƒœã‚¿ãƒ³ã®é…ç½®ãŒã©ã†ãªã£ã¦ã„ãŸã®ã‹è¦‹è¿”ã—ãŸããªã‚‹ãŸã‚ï¼‰&lt;/li>
&lt;li>ä¸Šè¨˜ã‚’keymapãƒªãƒã‚¸ãƒˆãƒªã«åæ˜ ã•ã›ã¦ãŠã&lt;/li>
&lt;/ul>
&lt;h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«&lt;/h2>
&lt;p>åˆå›ã¯è¨­å®šã§ç²¾ä¸€æ¯ã§é‹ç”¨(?)ã®ã“ã¨ã‚’å…¨ç„¶è€ƒãˆã¦ã„ãªã‹ã£ãŸã®ã§ã€ã€Œã‚ã‚Œjsonãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã—ã¦ãŸã£ã‘ã€ã€Œã‚­ãƒ¼ãƒãƒƒãƒ—ã®ç”»åƒã‚’ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦ãŠã„ãŸã¯ãšãªã‚“ã ã‘ã©ã©ã“ã‚„ã£ãŸã£ã‘ã€ãªã‚“ã¦ã‚ãŸã‚ãŸã—ã¦ã„ã¾ã—ãŸã€‚githubã«ä¸Šã’ã¦ãŠã‘ã°å®¶ã‹ã‚‰ã§ã‚‚ä¼šç¤¾ã‹ã‚‰ã§ã‚‚ã‚­ãƒ¼ãƒãƒƒãƒ—ç¢ºèªã§ãã‚‹ã—ã€ã“ã‚Œã§ãã£ã¨ä¸€å®‰å¿ƒğŸ˜Œ&lt;/p></description></item><item><title>About</title><link>https://reiichii.github.io/page/about/</link><pubDate>Sat, 28 May 2022 00:00:00 +0000</pubDate><guid>https://reiichii.github.io/page/about/</guid><description>&lt;p>æ—¥ã€…ã®ã‚ã‚Œã“ã‚Œã‚’å¿˜ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ãƒ–ãƒ­ã‚°ã§ã™ã€‚&lt;br>
ã‚¸ãƒ£ãƒ³ãƒ«ã¯çµã‚‰ãšã€æ°—ã®å‘ãã¾ã¾ã«ç¶šã‘ã¦ã„ã‘ãŸã‚‰ã¨æ€ã£ã¦ã„ã¾ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://reiichii.hateblo.jp/" target="_blank" rel="noopener"
>æ—§ãƒ–ãƒ­ã‚°ï¼ˆã¯ã¦ãªãƒ–ãƒ­ã‚°ï¼‰&lt;/a>&lt;/p></description></item><item><title>ãƒ–ãƒ­ã‚°å¼•ã£è¶Šã—ãŸ</title><link>https://reiichii.github.io/post/2022-05-27-16/</link><pubDate>Fri, 27 May 2022 17:01:55 +0900</pubDate><guid>https://reiichii.github.io/post/2022-05-27-16/</guid><description>&lt;img src="https://reiichii.github.io/post/2022-05-27-16/IMG_8179.jpg" alt="Featured image of post ãƒ–ãƒ­ã‚°å¼•ã£è¶Šã—ãŸ" />&lt;p>ã¯ã¦ãªã‹ã‚‰Hugoã§ç«‹ã¦ãŸãƒ–ãƒ­ã‚°ã«å¼•ã£è¶Šã—ã¾ã—ãŸã€‚&lt;/p>
&lt;p>å¤§ããªç†ç”±ã¨ã—ã¦ã¯ã€ä»¥å‰ã®ãƒ–ãƒ­ã‚°ã®è¦‹ãŸç›®ãŒæ°—ã«å…¥ã‚‰ãªã‹ã£ãŸï¼ˆã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®ã‚³ã‚¹ãƒˆãŒé«˜ã„ï¼‰ã“ã¨ã¨ã€vscodeã¨markdownã§ãƒ–ãƒ­ã‚°æ›¸ããŸã‹ã£ãŸã¨ã„ã†ã®ãŒä¸»ã§ã™ã€‚&lt;/p>
&lt;p>ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã¯Netlifyã‚’ä½¿ãŠã†ã‹æ‚©ã‚“ã ã®ã§ã™ãŒã€ãƒ–ãƒ­ã‚°ã®ç›®çš„ãŒã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®ç¿’æ…£ä»˜ã‘ãŒä¸»ã§ã€ã‚¢ã‚¯ã‚»ã‚¹æ•°ç¨¼ãã«åŠ›ã‚’å…¥ã‚Œã¦ã„ãªã„ã“ã¨ã¨ã€æ™®æ®µæ¥­å‹™ã§GitLabã‚’ä½¿ã†ã“ã¨ãŒå¤šã‹ã£ãŸã®ã§ã€GitHub Pagesã‚„CICDã‚’ã¡ã‚‡ã£ã¨è§¦ã£ã¦ã¿ãŸã„ãªã¨ã„ã†ã®ã‚‚ã‚ã‚Šã€ãƒŸãƒ‹ãƒãƒ ã«GitHub Pagesã§å§‹ã‚ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚å¾Œã‹ã‚‰ä¹—ã‚Šæ›ãˆã‚‹ã“ã¨ã‚‚ã§ããªãã¯ãªã„ã§ã™ã—ã€‚ãã®å ´åˆãƒ‰ãƒ¡ã‚¤ãƒ³å¤‰ã‚ã£ã¦ã—ã¾ã„ã¾ã™ãŒå€‹äººãƒ–ãƒ­ã‚°ã§ãƒªã‚¹ã‚¯ã‚‚ãªã„ã®ã§æ°—ã®å‘ãã¾ã¾ã«ã‚„ã£ã¦ã„ãæ–¹é‡ã§ğŸ˜Œ&lt;/p>
&lt;p>æ—¢å­˜ã®ãƒ–ãƒ­ã‚°ã¨è¨˜äº‹ã¯ç‰¹ã«exportã›ãšãã®ã¾ã¾æ®‹ã—ã¦ãŠãäºˆå®šã§ã™ã€‚ï¼ˆã‚‚ã—ã‹ã—ãŸã‚‰æˆ»ã‚‹å¯èƒ½æ€§ã‚‚ãªãã¯ãªã„ã®ã§ï¼‰&lt;/p>
&lt;p>ã“ã‚Œã‹ã‚‰ã‚‚ãƒã‚¤ãƒšãƒ¼ã‚¹ã«ç¶šã‘ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://reiichii.hateblo.jp/" target="_blank" rel="noopener"
>ä»¥å‰ã®ãƒ–ãƒ­ã‚°&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://reiichii.github.io/post/2022-05-27-16/IMG_8179.jpg"
width="2448"
height="1471"
srcset="https://reiichii.github.io/post/2022-05-27-16/IMG_8179_hu05940ea99d8537e6bd20faf24b516d8b_1077440_480x0_resize_q75_box.jpg 480w, https://reiichii.github.io/post/2022-05-27-16/IMG_8179_hu05940ea99d8537e6bd20faf24b516d8b_1077440_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
alt="ã“ãªã„ã é£Ÿã¹ãŸã‚³ãƒ¼ã‚¹æ–™ç†ã®ãƒ‡ã‚¶ãƒ¼ãƒˆã®ç¾Šãƒ¢ãƒŠã‚«å¯æ„›ã‹ã£ãŸ"
class="gallery-image"
data-flex-grow="166"
data-flex-basis="399px"
>&lt;/p></description></item><item><title>Archives</title><link>https://reiichii.github.io/page/archives/</link><pubDate>Tue, 28 May 2019 00:00:00 +0000</pubDate><guid>https://reiichii.github.io/page/archives/</guid><description/></item><item><title>Search</title><link>https://reiichii.github.io/page/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://reiichii.github.io/page/search/</guid><description/></item></channel></rss>